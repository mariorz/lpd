{
"version":3,
"file":"module$node_modules$$walletconnect$socket_transport$dist$cjs$index.js",
"lineCount":8,
"mappings":"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",
"sources":["node_modules/@walletconnect/socket-transport/dist/cjs/index.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$walletconnect$socket_transport$dist$cjs$index\"] = function(global,require,module,exports) {\n\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\nconst utils_1 = require(\"@walletconnect/utils\");\nconst network_1 = tslib_1.__importDefault(require(\"./network\"));\nconst WS = typeof global.WebSocket !== \"undefined\" ? global.WebSocket : require(\"ws\");\nclass SocketTransport {\n    constructor(opts) {\n        this._queue = [];\n        this._events = [];\n        this._subscriptions = [];\n        this._protocol = opts.protocol;\n        this._version = opts.version;\n        this._url = \"\";\n        this._netMonitor = null;\n        this._socket = null;\n        this._nextSocket = null;\n        this._subscriptions = opts.subscriptions || [];\n        this._netMonitor = opts.netMonitor || new network_1.default();\n        if (!opts.url || typeof opts.url !== \"string\") {\n            throw new Error(\"Missing or invalid WebSocket url\");\n        }\n        this._url = opts.url;\n        this._netMonitor.on(\"online\", () => this._socketCreate());\n    }\n    set readyState(value) {\n    }\n    get readyState() {\n        return this._socket ? this._socket.readyState : -1;\n    }\n    set connecting(value) {\n    }\n    get connecting() {\n        return this.readyState === 0;\n    }\n    set connected(value) {\n    }\n    get connected() {\n        return this.readyState === 1;\n    }\n    set closing(value) {\n    }\n    get closing() {\n        return this.readyState === 2;\n    }\n    set closed(value) {\n    }\n    get closed() {\n        return this.readyState === 3;\n    }\n    open() {\n        this._socketCreate();\n    }\n    close() {\n        this._socketClose();\n    }\n    send(message, topic, silent) {\n        if (!topic || typeof topic !== \"string\") {\n            throw new Error(\"Missing or invalid topic field\");\n        }\n        this._socketSend({\n            topic: topic,\n            type: \"pub\",\n            payload: message,\n            silent: !!silent,\n        });\n    }\n    subscribe(topic) {\n        this._socketSend({\n            topic: topic,\n            type: \"sub\",\n            payload: \"\",\n            silent: true,\n        });\n    }\n    on(event, callback) {\n        this._events.push({ event, callback });\n    }\n    _socketCreate() {\n        if (this._nextSocket) {\n            return;\n        }\n        const url = getWebSocketUrl(this._url, this._protocol, this._version);\n        this._nextSocket = new WS(url);\n        if (!this._nextSocket) {\n            throw new Error(\"Failed to create socket\");\n        }\n        this._nextSocket.onmessage = (event) => this._socketReceive(event);\n        this._nextSocket.onopen = () => this._socketOpen();\n        this._nextSocket.onerror = (event) => this._socketError(event);\n        this._nextSocket.onclose = () => {\n            this._nextSocket = null;\n            this._socketCreate();\n        };\n    }\n    _socketOpen() {\n        this._socketClose();\n        this._socket = this._nextSocket;\n        this._nextSocket = null;\n        this._queueSubscriptions();\n        this._pushQueue();\n    }\n    _socketClose() {\n        if (this._socket) {\n            this._socket.onclose = () => {\n            };\n            this._socket.close();\n        }\n    }\n    _socketSend(socketMessage) {\n        const message = JSON.stringify(socketMessage);\n        if (this._socket && this._socket.readyState === 1) {\n            this._socket.send(message);\n        }\n        else {\n            this._setToQueue(socketMessage);\n            this._socketCreate();\n        }\n    }\n    _socketReceive(event) {\n        return tslib_1.__awaiter(this, void 0, void 0, function* () {\n            let socketMessage;\n            try {\n                socketMessage = JSON.parse(event.data);\n            }\n            catch (error) {\n                return;\n            }\n            this._socketSend({\n                topic: socketMessage.topic,\n                type: \"ack\",\n                payload: \"\",\n                silent: true,\n            });\n            if (this._socket && this._socket.readyState === 1) {\n                const events = this._events.filter(event => event.event === \"message\");\n                if (events && events.length) {\n                    events.forEach(event => event.callback(socketMessage));\n                }\n            }\n        });\n    }\n    _socketError(e) {\n        const events = this._events.filter(event => event.event === \"error\");\n        if (events && events.length) {\n            events.forEach(event => event.callback(e));\n        }\n    }\n    _queueSubscriptions() {\n        const subscriptions = this._subscriptions;\n        subscriptions.forEach((topic) => this._queue.push({\n            topic: topic,\n            type: \"sub\",\n            payload: \"\",\n            silent: true,\n        }));\n        this._subscriptions = [];\n    }\n    _setToQueue(socketMessage) {\n        this._queue.push(socketMessage);\n    }\n    _pushQueue() {\n        const queue = this._queue;\n        queue.forEach((socketMessage) => this._socketSend(socketMessage));\n        this._queue = [];\n    }\n}\nfunction getWebSocketUrl(_url, protocol, version) {\n    var _a, _b;\n    const url = _url.startsWith(\"https\")\n        ? _url.replace(\"https\", \"wss\")\n        : _url.startsWith(\"http\")\n            ? _url.replace(\"http\", \"ws\")\n            : _url;\n    const splitUrl = url.split(\"?\");\n    const params = utils_1.isBrowser()\n        ? {\n            protocol,\n            version,\n            env: \"browser\",\n            host: ((_a = utils_1.getLocation()) === null || _a === void 0 ? void 0 : _a.host) || \"\",\n        }\n        : {\n            protocol,\n            version,\n            env: ((_b = utils_1.detectEnv()) === null || _b === void 0 ? void 0 : _b.name) || \"\",\n        };\n    const queryString = utils_1.appendToQueryString(utils_1.getQueryString(splitUrl[1] || \"\"), params);\n    return splitUrl[0] + \"?\" + queryString;\n}\nexports.default = SocketTransport;\n//# sourceMappingURL=index.js.map\n};"],
"names":["shadow$provide","global","require","module","exports","getWebSocketUrl","_url","protocol","version","_a","_b","splitUrl","startsWith","url","replace","split","params","utils_1","isBrowser","env","host","getLocation","detectEnv","name","queryString","appendToQueryString","getQueryString","Object","defineProperty","value","tslib_1","network_1","__importDefault","WS","WebSocket","SocketTransport","constructor","opts","_queue","_events","_subscriptions","_protocol","_version","_nextSocket","_socket","_netMonitor","subscriptions","netMonitor","default","Error","on","_socketCreate","readyState","open","close","_socketClose","send","message","topic","silent","_socketSend","type","payload","subscribe","event","callback","push","onmessage","this._nextSocket.onmessage","_socketReceive","onopen","this._nextSocket.onopen","_socketOpen","onerror","this._nextSocket.onerror","_socketError","onclose","this._nextSocket.onclose","_queueSubscriptions","_pushQueue","this._socket.onclose","socketMessage","JSON","stringify","_setToQueue","__awaiter","parse","data","error","events","filter","length","forEach","e"]
}
