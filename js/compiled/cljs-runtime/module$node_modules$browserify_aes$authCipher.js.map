{
"version":3,
"file":"module$node_modules$browserify_aes$authCipher.js",
"lineCount":6,
"mappings":"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",
"sources":["node_modules/browserify-aes/authCipher.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$browserify_aes$authCipher\"] = function(global,require,module,exports) {\nvar aes = require('./aes')\nvar Buffer = require('safe-buffer').Buffer\nvar Transform = require('cipher-base')\nvar inherits = require('inherits')\nvar GHASH = require('./ghash')\nvar xor = require('buffer-xor')\nvar incr32 = require('./incr32')\n\nfunction xorTest (a, b) {\n  var out = 0\n  if (a.length !== b.length) out++\n\n  var len = Math.min(a.length, b.length)\n  for (var i = 0; i < len; ++i) {\n    out += (a[i] ^ b[i])\n  }\n\n  return out\n}\n\nfunction calcIv (self, iv, ck) {\n  if (iv.length === 12) {\n    self._finID = Buffer.concat([iv, Buffer.from([0, 0, 0, 1])])\n    return Buffer.concat([iv, Buffer.from([0, 0, 0, 2])])\n  }\n  var ghash = new GHASH(ck)\n  var len = iv.length\n  var toPad = len % 16\n  ghash.update(iv)\n  if (toPad) {\n    toPad = 16 - toPad\n    ghash.update(Buffer.alloc(toPad, 0))\n  }\n  ghash.update(Buffer.alloc(8, 0))\n  var ivBits = len * 8\n  var tail = Buffer.alloc(8)\n  tail.writeUIntBE(ivBits, 0, 8)\n  ghash.update(tail)\n  self._finID = ghash.state\n  var out = Buffer.from(self._finID)\n  incr32(out)\n  return out\n}\nfunction StreamCipher (mode, key, iv, decrypt) {\n  Transform.call(this)\n\n  var h = Buffer.alloc(4, 0)\n\n  this._cipher = new aes.AES(key)\n  var ck = this._cipher.encryptBlock(h)\n  this._ghash = new GHASH(ck)\n  iv = calcIv(this, iv, ck)\n\n  this._prev = Buffer.from(iv)\n  this._cache = Buffer.allocUnsafe(0)\n  this._secCache = Buffer.allocUnsafe(0)\n  this._decrypt = decrypt\n  this._alen = 0\n  this._len = 0\n  this._mode = mode\n\n  this._authTag = null\n  this._called = false\n}\n\ninherits(StreamCipher, Transform)\n\nStreamCipher.prototype._update = function (chunk) {\n  if (!this._called && this._alen) {\n    var rump = 16 - (this._alen % 16)\n    if (rump < 16) {\n      rump = Buffer.alloc(rump, 0)\n      this._ghash.update(rump)\n    }\n  }\n\n  this._called = true\n  var out = this._mode.encrypt(this, chunk)\n  if (this._decrypt) {\n    this._ghash.update(chunk)\n  } else {\n    this._ghash.update(out)\n  }\n  this._len += chunk.length\n  return out\n}\n\nStreamCipher.prototype._final = function () {\n  if (this._decrypt && !this._authTag) throw new Error('Unsupported state or unable to authenticate data')\n\n  var tag = xor(this._ghash.final(this._alen * 8, this._len * 8), this._cipher.encryptBlock(this._finID))\n  if (this._decrypt && xorTest(tag, this._authTag)) throw new Error('Unsupported state or unable to authenticate data')\n\n  this._authTag = tag\n  this._cipher.scrub()\n}\n\nStreamCipher.prototype.getAuthTag = function getAuthTag () {\n  if (this._decrypt || !Buffer.isBuffer(this._authTag)) throw new Error('Attempting to get auth tag in unsupported state')\n\n  return this._authTag\n}\n\nStreamCipher.prototype.setAuthTag = function setAuthTag (tag) {\n  if (!this._decrypt) throw new Error('Attempting to set auth tag in unsupported state')\n\n  this._authTag = tag\n}\n\nStreamCipher.prototype.setAAD = function setAAD (buf) {\n  if (this._called) throw new Error('Attempting to set AAD in unsupported state')\n\n  this._ghash.update(buf)\n  this._alen += buf.length\n}\n\nmodule.exports = StreamCipher\n\n};"],
"names":["shadow$provide","global","require","module","exports","StreamCipher","mode","key","iv","decrypt","Transform","call","h","Buffer","alloc","_cipher","aes","AES","ck","encryptBlock","_ghash","GHASH","length","self","_finID","concat","from","ghash","len","toPad","update","ivBits","tail","writeUIntBE","state","out","incr32","_prev","_cache","allocUnsafe","_secCache","_decrypt","_len","_alen","_mode","_authTag","_called","inherits","xor","prototype","_update","StreamCipher.prototype._update","chunk","rump","encrypt","_final","StreamCipher.prototype._final","Error","tag","final","a","b","Math","min","i","scrub","getAuthTag","StreamCipher.prototype.getAuthTag","isBuffer","setAuthTag","StreamCipher.prototype.setAuthTag","setAAD","StreamCipher.prototype.setAAD","buf"]
}
