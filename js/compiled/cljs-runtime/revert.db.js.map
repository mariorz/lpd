{"version":3,"sources":["revert/db.cljs"],"mappings":";AAEA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAKA","names":["revert.db/default-db"],"sourcesContent":["(ns revert.db)\n\n(def default-db\n  {:name \"revertdb\"\n   :connected false\n   :loading false\n   :account nil\n   :pool-address nil\n   :loading-msgs []\n   :pool-histories {}\n   :tokens {}\n   :pools {}\n   :blocks-ts {}\n   :expanded-logs #{}\n   :ignored-pools #{}\n   :v3ignored-pools #{}\n   :lp-positions {}\n   :block-ts-loading 0\n   :include-exited false\n   :account-loaded false\n   :univ3-state-loaded false\n   :pool-histories-loaded false\n   :pool-stakings-loaded false})\n\n\n\n;; :pool-histories\n;; ---------------------------------------------------------------\n;; {pool-address [daily-snapshots1,2,3....]}\n;; daily snapshots are orderd from latest to oldest\n;; daily-snapshot:\n;; {:exchange \"uniswap\"\n;;  :address ..\n;;  :date 1617840000\n;;  :timestamp #inst \"2021-04-08T00:00:00.000-00:00\"\n;;  :token0-decimals 18\n;;  :token0-symbol \"WETH\"\n;;  :token0-address ...\n;;  :token0-name \"Wrapped Ether\"\n;;  :token1-decimals 18\n;;  :token1-symbol \"ALCX\"\n;;  :token1-address ...\n;;  :token1-name \"Alchemix\"\n;;  :reserve0 #object[BigNumber 61477.465263864755791416]\n;;  :reserve1 #object[BigNumber 71555.632654234097991539]\n;;  :reserves-usd #object[BigNumber 71555.632654234097991539]\n;;  :volume0 #object[BigNumber 3979.965223995177815974]\n;;  :volume1 #object[BigNumber 4671.00164386111070952]\n;;  :volume-usd #object[BigNumber 8030147.054029627971589382870269372]\n;;  :total-supply #object[BigNumber 63869.431132131766614604]\n;;  :token0-price #object[BigNumber 639.431604]\n;;  :token1-price #object[BigNumber 2339.1604]\n;;  :price-divergence #object[BigNumber 23.334]\n;;  :volume-usd-derived #object[BigNumber 12111254.70761783746792574687]\n;;  :vol-res-ratio #object[BigNumber 0.04596779952082076122]\n;;  :usd-diff #object[BigNumber -3.802828427524786302]}\n\n\n;; :v3pool-histories\n;; ---------------------------------------------------------------\n;; {pool-address [daily-snapshots1,2,3....]}\n;; daily snapshots are orderd from latest to oldest\n;; daily-snapshot:\n;; {:exchange \"uniswap\"\n;;  :address ..\n;;  :date 1617840000\n;;  :timestamp #inst \"2021-04-08T00:00:00.000-00:00\"\n;;  :token0-decimals 18\n;;  :token0-symbol \"WETH\"\n;;  :token0-address ...\n;;  :token0-name \"Wrapped Ether\"\n;;  :token1-decimals 18\n;;  :token1-symbol \"ALCX\"\n;;  :token1-address ...\n;;  :token1-name \"Alchemix\"\n;;  :reserves-usd #object[BigNumber 71555.632654234097991539]\n;;  :volume0 #object[BigNumber 3979.965223995177815974]\n;;  :volume1 #object[BigNumber 4671.00164386111070952]\n;;  :volume-usd #object[BigNumber 8030147.054029627971589382870269372]\n;;  :liquidity #object[BigNumber 63869.431132131766614604]\n;;  :token0-price #object[BigNumber 639.431604]\n;;  :token1-price #object[BigNumber 2339.1604]\n;;  :token0-price-usd #object[BigNumber 639.431604]\n;;  :token1-price-usd #object[BigNumber 2339.1604]\n;;  :price-divergence #object[BigNumber 23.334]\n;;  :vol-res-ratio #object[BigNumber 0.04596779952082076122]\n;;  :usd-diff #object[BigNumber -3.802828427524786302]\n;;  :sqrt-price #object[BigNumber -3.802828427524786302]\n;;  :tick #object[BigNumber -3.802828427524786302]}\n\n\n;; :pools\n;; ---------------------------------------------------------------\n;; {pool-address pool}\n;; pool:\n;; {:address ...\n;;  :exchange \"sushiswap\"\n;;  :token0-address\n;;  :token1-address\n;;  :reserve0 #object[BigNumber 61477.465263864755791416]\n;;  :reserve1 #object[BigNumber 71555.632654234097991539]\n;;  :total-supply #object[BigNumber 63869.431132131766614604]}}\n\n\n;; :v3pools\n;; ---------------------------------------------------------------\n;; {pool-address pool}\n;; pool:\n;; {:address ...\n;;  :exchange \"uniswapv3\"\n;;  :token0-address ...\n;;  :token1-address ...\n;;  :fee-tier #object[BigNumber 61477.465263864755791416]\n;;  :liquidity #object[BigNumber 61477.465263864755791416]\n;;  :sqrt-price #object[BigNumber 61477.465263864755791416]\n;;  :tick 123434\n;;  :fee-growth-global0\n;;  :fee-growth-global1\n;;  :volume0 #object[BigNumber 61477.465263864755791416]\n;;  :volume1 #object[BigNumber 61477.465263864755791416]\n;;  :volume-usd #object[BigNumber 61477.465263864755791416]\n;;  :reserve0 #object[BigNumber 61477.465263864755791416]\n;;  :reserve1 #object[BigNumber 71555.632654234097991539]\n;;  :reserve-total-eth #object[BigNumber 61477.465263864755791416]\n;;  :reserve-total-usd #object[BigNumber 61477.465263864755791416]\n;;  :lp-count #object[BigNumber 61477.465263864755791416]\n;;  :total-supply #object[BigNumber 63869.431132131766614604]}}\n\n\n\n\n\n;; :tokens\n;; ---------------------------------------------------------------\n;; {token-address token-info}\n;;  token-info:\n;;  {:address ..\n;;   :decimals 18\n;;   :name \"Alchemix\"\n;;   :symbol \"ALCX\"\n;;   :prices {:usd #object[BigNumber 10000.00]}}\n\n\n;; :lp-positions\n;; ---------------------------------------------------------------\n;; [lp-position1, lp-position2]\n;; {pool-address {lp-position}}\n;; lp-position:\n;; {:address ...\n;;  :lp-shares ...\n;;  :account-matches true ;; true when all lp-tokens are accounted for: mints-burns=wallet+staked\n;;  :mints [{:block-number 1020102\n;;           :txhash ...\n;;           :deposits {\"0x0bc529c00c6401aef6d220be8c6ea1667f6ad93e\" #object[BigNumber 0.015]\n;;                      \"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2\" #object[BigNumber 1.006628907886794181]}\n;;           :gas-price #object[BigNumber 100.015]\n;;           :gas-used #object[BigNumber 1000.015]\n;;           :lp-minted #object[BigNumber 0.085]}]\n;;  :burns [{:block-number 1020102\n;;           :tx-hash ...\n;;           :withdrawaps {\"0x0bc529c00c6401aef6d220be8c6ea1667f6ad93e\" #object[BigNumber 0.015]\n;;                         \"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2\" #object[BigNumber 1.0]}\n;;           :gas-price #object[BigNumber 100.015]\n;;           :gas-used #object[BigNumber 1000.015]\n;;           :lp-burned #object[BigNumber 0.085]}]\n;;  :stakings [{:staking-address ...\n;;              :lp-shares #object[BigNumber 1.01]\n;;              :stakings [txhash1, txhash2]\n;;              :rewards [{:reward-token-address ...\n;;                         :pending-rewards #object[BigNumber 10.015]\n;;                         :paid-rewards [{:block-number 123\n;;                                         :tx-hash ...\n;;                                         :qty #object[BigNumber 13.15]}]}]}]\n;;  :txs-out {txhash {:amount #object[BigNumber 10.01]\n;;                    :from-address ...\n;;                    :to-address ...\n;;                    :txhash ...\n;;                    :block-number 123}}}\n\n\n\n\n\n;; :v3lp-positions\n;; ---------------------------------------------------------------\n;; [lp-position1, lp-position2]\n;; lp-position:\n;;  [\n;;   {:nft-id 123\n;;    :address ..\n;;    :token0 ..\n;;    :token1 ..\n;;    :liquidity\n;;    :tick-lower #object[BigNumber 1000.015]\n;;    :tick-uppwer #object[BigNumber 1000.015]\n;;    :fee-tier #object[BigNumber 1000.015]\n;;    :fee-growth-outside-lower0\n;;    :fee-growth-outside-lower1\n;;    :fee-growth-outside-upper0\n;;    :fee-growth-outside-upper1\n;;    :fee-growth-inside0\n;;    :fee-growth-inside1\n;;    :tokens-owed0\n;;    :tokens-owed1\n;;    :amount0\n;;    :amount1\n;;    :pending-fees0\n;;    :pending-fees1\n;;    :mints [{:block-number 1020102\n;;             :txhash ...\n;;             :deposits {\"0x0bc529c00c6401aef6d220be8c6ea1667f6ad93e\" #object[BigNumber 0.015]\n;;                        \"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2\" #object[BigNumber 1.006628907886794181]}\n;;             :liquidity #object[BigNumber 1000.015]\n;;             :gas-price #object[BigNumber 100.015]\n;;             :gas-used #object[BigNumber 1000.015]}]\n;;    :burns [{:block-number 1020102\n;;             :tx-hash ...\n;;             :withdrawals {\"0x0bc529c00c6401aef6d220be8c6ea1667f6ad93e\" #object[BigNumber 0.015]\n;;                           \"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2\" #object[BigNumber 1.0]}\n;;             :gas-price #object[BigNumber 100.015]\n;;             :gas-used #object[BigNumber 1000.015]\n;;             :liquidity #object[BigNumber 0.085]}]\n;;    :collects [{:block-number 1020102\n;;                :tx-hash ...\n;;                :withdrawals {\"0x0bc529c00c6401aef6d220be8c6ea1667f6ad93e\" #object[BigNumber 0.015]\n;;                              \"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2\" #object[BigNumber 1.0]}\n;;                :gas-price #object[BigNumber 100.015]\n;;                :gas-used #object[BigNumber 1000.015]]\n\n\n\n\n\n\n;; calculate ROI\n;; total-pnl/pool-assets-value\n\n\n;; calculate APR\n;; (roi / days from initial investment) * 365\n\n;; calculating APY at current prices\n;; get all mint events usd value including gas costs (with dates) (deposits)\n;; get all burn events usd value substracting gas costs (with dates) (withdrawals)\n;; get all claimed rewards substracting gas costs (with dates) (withdrawals)\n;; get all unclaimed rewards (this can be taken as withdrwal at present date)\n;; get all underlying tokens usd vale (this can be taken as withdrawal at present date)\n;; apply irr formula\n;; THE PROBLEM with this is that rewards are not actually compounding while pool returns are\n"]}