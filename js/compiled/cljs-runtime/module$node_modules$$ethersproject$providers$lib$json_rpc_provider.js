shadow$provide.module$node_modules$$ethersproject$providers$lib$json_rpc_provider=function(global,require,module,exports){function checkError(method,error,params){if("call"===method&&error.code===logger_1.Logger.errors.SERVER_ERROR){var e=error.error;if(e&&e.message.match("reverted")&&bytes_1.isHexString(e.data))return e.data}e=error.message;error.code===logger_1.Logger.errors.SERVER_ERROR&&error.error&&"string"===typeof error.error.message?e=error.error.message:"string"===typeof error.body?e=error.body:
"string"===typeof error.responseText&&(e=error.responseText);e=(e||"").toLowerCase();params=params.transaction||params.signedTransaction;e.match(/insufficient funds/)&&logger.throwError("insufficient funds for intrinsic transaction cost",logger_1.Logger.errors.INSUFFICIENT_FUNDS,{error,method,transaction:params});e.match(/nonce too low/)&&logger.throwError("nonce has already been used",logger_1.Logger.errors.NONCE_EXPIRED,{error,method,transaction:params});e.match(/replacement transaction underpriced/)&&
logger.throwError("replacement fee too low",logger_1.Logger.errors.REPLACEMENT_UNDERPRICED,{error,method,transaction:params});0<=errorGas.indexOf(method)&&e.match(/gas required exceeds allowance|always failing transaction|execution reverted/)&&logger.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",logger_1.Logger.errors.UNPREDICTABLE_GAS_LIMIT,{error,method,transaction:params});throw error;}function timer(timeout){return new Promise(function(resolve){setTimeout(resolve,
timeout)})}function getResult(payload){if(payload.error){var error=Error(payload.error.message);error.code=payload.error.code;error.data=payload.error.data;throw error;}return payload.result}function getLowerCase(value){return value?value.toLowerCase():value}var __extends=this&&this.__extends||function(){var extendStatics=function(d$jscomp$0,b$jscomp$0){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,
p)&&(d[p]=b[p])};return extendStatics(d$jscomp$0,b$jscomp$0)};return function(d,b){function __(){this.constructor=d}if("function"!==typeof b&&null!==b)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new (P||
(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=this&&this.__generator||function(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");
for(;_;)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=0<t.length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&
_.label<t[1])_.label=t[1],t=op;else if(t&&_.label<t[2])_.label=t[2],_.ops.push(op);else{t[2]&&_.ops.pop();_.trys.pop();continue}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),"throw":verb(1),"return":verb(2)},"function"===typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g};Object.defineProperty(exports,
"__esModule",{value:!0});exports.JsonRpcProvider=exports.JsonRpcSigner=void 0;global=require("module$node_modules$$ethersproject$abstract_signer$lib$index");var bignumber_1=require("module$node_modules$$ethersproject$bignumber$lib$index"),bytes_1=require("module$node_modules$$ethersproject$bytes$lib$index"),hash_1=require("module$node_modules$$ethersproject$hash$lib$index"),properties_1=require("module$node_modules$$ethersproject$properties$lib$index"),strings_1=require("module$node_modules$$ethersproject$strings$lib$index"),
web_1=require("module$node_modules$$ethersproject$web$lib$index"),logger_1=require("module$node_modules$$ethersproject$logger$lib$index");module=require("module$node_modules$$ethersproject$providers$lib$_version");var logger=new logger_1.Logger(module.version);require=require("module$node_modules$$ethersproject$providers$lib$base_provider");var errorGas=["call","estimateGas"],_constructorGuard={},JsonRpcSigner=function(_super){function JsonRpcSigner(constructorGuard,provider,addressOrIndex){logger.checkNew(this.constructor,
JsonRpcSigner);var _this=_super.call(this)||this;if(constructorGuard!==_constructorGuard)throw Error("do not call the JsonRpcSigner constructor directly; use provider.getSigner");properties_1.defineReadOnly(_this,"provider",provider);null==addressOrIndex&&(addressOrIndex=0);"string"===typeof addressOrIndex?(properties_1.defineReadOnly(_this,"_address",_this.provider.formatter.address(addressOrIndex)),properties_1.defineReadOnly(_this,"_index",null)):"number"===typeof addressOrIndex?(properties_1.defineReadOnly(_this,
"_index",addressOrIndex),properties_1.defineReadOnly(_this,"_address",null)):logger.throwArgumentError("invalid address or index","addressOrIndex",addressOrIndex);return _this}__extends(JsonRpcSigner,_super);JsonRpcSigner.prototype.connect=function(provider){return logger.throwError("cannot alter JSON-RPC Signer connection",logger_1.Logger.errors.UNSUPPORTED_OPERATION,{operation:"connect"})};JsonRpcSigner.prototype.connectUnchecked=function(){return new UncheckedJsonRpcSigner(_constructorGuard,this.provider,
this._address||this._index)};JsonRpcSigner.prototype.getAddress=function(){var _this=this;return this._address?Promise.resolve(this._address):this.provider.send("eth_accounts",[]).then(function(accounts){accounts.length<=_this._index&&logger.throwError("unknown account #"+_this._index,logger_1.Logger.errors.UNSUPPORTED_OPERATION,{operation:"getAddress"});return _this.provider.formatter.address(accounts[_this._index])})};JsonRpcSigner.prototype.sendUncheckedTransaction=function(transaction){var _this=
this;transaction=properties_1.shallowCopy(transaction);var fromAddress=this.getAddress().then(function(address){address&&(address=address.toLowerCase());return address});if(null==transaction.gasLimit){var estimate=properties_1.shallowCopy(transaction);estimate.from=fromAddress;transaction.gasLimit=this.provider.estimateGas(estimate)}return properties_1.resolveProperties({tx:properties_1.resolveProperties(transaction),sender:fromAddress}).then(function(_a){var tx=_a.tx;_a=_a.sender;null!=tx.from?tx.from.toLowerCase()!==
_a&&logger.throwArgumentError("from address mismatch","transaction",transaction):tx.from=_a;var hexTx=_this.provider.constructor.hexlifyTransaction(tx,{from:!0});return _this.provider.send("eth_sendTransaction",[hexTx]).then(function(hash){return hash},function(error){return checkError("sendTransaction",error,hexTx)})})};JsonRpcSigner.prototype.signTransaction=function(transaction){return logger.throwError("signing transactions is unsupported",logger_1.Logger.errors.UNSUPPORTED_OPERATION,{operation:"signTransaction"})};
JsonRpcSigner.prototype.sendTransaction=function(transaction){var _this=this;return this.sendUncheckedTransaction(transaction).then(function(hash){return web_1.poll(function(){return _this.provider.getTransaction(hash).then(function(tx){if(null!==tx)return _this.provider._wrapTransaction(tx,hash)})},{onceBlock:_this.provider}).catch(function(error){error.transactionHash=hash;throw error;})})};JsonRpcSigner.prototype.signMessage=function(message){return __awaiter(this,void 0,void 0,function(){var data,
address;return __generator(this,function(_a){switch(_a.label){case 0:return data="string"===typeof message?strings_1.toUtf8Bytes(message):message,[4,this.getAddress()];case 1:return address=_a.sent(),[4,this.provider.send("eth_sign",[address.toLowerCase(),bytes_1.hexlify(data)])];case 2:return[2,_a.sent()]}})})};JsonRpcSigner.prototype._signTypedData=function(domain,types,value){return __awaiter(this,void 0,void 0,function(){var populated,address,_this=this;return __generator(this,function(_a){switch(_a.label){case 0:return[4,
hash_1._TypedDataEncoder.resolveNames(domain,types,value,function(name){return _this.provider.resolveName(name)})];case 1:return populated=_a.sent(),[4,this.getAddress()];case 2:return address=_a.sent(),[4,this.provider.send("eth_signTypedData_v4",[address.toLowerCase(),JSON.stringify(hash_1._TypedDataEncoder.getPayload(populated.domain,types,populated.value))])];case 3:return[2,_a.sent()]}})})};JsonRpcSigner.prototype.unlock=function(password){return __awaiter(this,void 0,void 0,function(){var provider,
address;return __generator(this,function(_a){switch(_a.label){case 0:return provider=this.provider,[4,this.getAddress()];case 1:return address=_a.sent(),[2,provider.send("personal_unlockAccount",[address.toLowerCase(),password,null])]}})})};return JsonRpcSigner}(global.Signer);exports.JsonRpcSigner=JsonRpcSigner;var UncheckedJsonRpcSigner=function(_super){function UncheckedJsonRpcSigner(){return null!==_super&&_super.apply(this,arguments)||this}__extends(UncheckedJsonRpcSigner,_super);UncheckedJsonRpcSigner.prototype.sendTransaction=
function(transaction){var _this=this;return this.sendUncheckedTransaction(transaction).then(function(hash){return{hash,nonce:null,gasLimit:null,gasPrice:null,data:null,value:null,chainId:null,confirmations:0,from:null,wait:function(confirmations){return _this.provider.waitForTransaction(hash,confirmations)}}})};return UncheckedJsonRpcSigner}(JsonRpcSigner),allowedTransactionKeys={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,value:!0};require=function(_super){function JsonRpcProvider(url,
network$jscomp$0){var _this=this;logger.checkNew(this.constructor,JsonRpcProvider);null==network$jscomp$0&&(network$jscomp$0=new Promise(function(resolve,reject){setTimeout(function(){_this.detectNetwork().then(function(network){resolve(network)},function(error){reject(error)})},0)}));_this=_super.call(this,network$jscomp$0)||this;url||(url=properties_1.getStatic(_this.constructor,"defaultUrl")());"string"===typeof url?properties_1.defineReadOnly(_this,"connection",Object.freeze({url})):properties_1.defineReadOnly(_this,
"connection",Object.freeze(properties_1.shallowCopy(url)));_this._nextId=42;return _this}__extends(JsonRpcProvider,_super);JsonRpcProvider.defaultUrl=function(){return"http://localhost:8545"};JsonRpcProvider.prototype.detectNetwork=function(){return __awaiter(this,void 0,void 0,function(){var chainId,getNetwork;return __generator(this,function(_a){switch(_a.label){case 0:return[4,timer(0)];case 1:_a.sent(),chainId=null,_a.label=2;case 2:return _a.trys.push([2,4,,9]),[4,this.send("eth_chainId",[])];
case 3:return chainId=_a.sent(),[3,9];case 4:_a.sent(),_a.label=5;case 5:return _a.trys.push([5,7,,8]),[4,this.send("net_version",[])];case 6:return chainId=_a.sent(),[3,8];case 7:return _a.sent(),[3,8];case 8:return[3,9];case 9:if(null!=chainId){getNetwork=properties_1.getStatic(this.constructor,"getNetwork");try{return[2,getNetwork(bignumber_1.BigNumber.from(chainId).toNumber())]}catch(error){return[2,logger.throwError("could not detect network",logger_1.Logger.errors.NETWORK_ERROR,{chainId,event:"invalidNetwork",
serverError:error})]}}return[2,logger.throwError("could not detect network",logger_1.Logger.errors.NETWORK_ERROR,{event:"noNetwork"})]}})})};JsonRpcProvider.prototype.getSigner=function(addressOrIndex){return new JsonRpcSigner(_constructorGuard,this,addressOrIndex)};JsonRpcProvider.prototype.getUncheckedSigner=function(addressOrIndex){return this.getSigner(addressOrIndex).connectUnchecked()};JsonRpcProvider.prototype.listAccounts=function(){var _this=this;return this.send("eth_accounts",[]).then(function(accounts){return accounts.map(function(a){return _this.formatter.address(a)})})};
JsonRpcProvider.prototype.send=function(method,params){var _this=this,request={method,params,id:this._nextId++,jsonrpc:"2.0"};this.emit("debug",{action:"request",request:properties_1.deepCopy(request),provider:this});return web_1.fetchJson(this.connection,JSON.stringify(request),getResult).then(function(result){_this.emit("debug",{action:"response",request,response:result,provider:_this});return result},function(error){_this.emit("debug",{action:"response",error,request,provider:_this});throw error;
})};JsonRpcProvider.prototype.prepareRequest=function(method,params){switch(method){case "getBlockNumber":return["eth_blockNumber",[]];case "getGasPrice":return["eth_gasPrice",[]];case "getBalance":return["eth_getBalance",[getLowerCase(params.address),params.blockTag]];case "getTransactionCount":return["eth_getTransactionCount",[getLowerCase(params.address),params.blockTag]];case "getCode":return["eth_getCode",[getLowerCase(params.address),params.blockTag]];case "getStorageAt":return["eth_getStorageAt",
[getLowerCase(params.address),params.position,params.blockTag]];case "sendTransaction":return["eth_sendRawTransaction",[params.signedTransaction]];case "getBlock":if(params.blockTag)return["eth_getBlockByNumber",[params.blockTag,!!params.includeTransactions]];if(params.blockHash)return["eth_getBlockByHash",[params.blockHash,!!params.includeTransactions]];break;case "getTransaction":return["eth_getTransactionByHash",[params.transactionHash]];case "getTransactionReceipt":return["eth_getTransactionReceipt",
[params.transactionHash]];case "call":return method=properties_1.getStatic(this.constructor,"hexlifyTransaction"),["eth_call",[method(params.transaction,{from:!0}),params.blockTag]];case "estimateGas":return method=properties_1.getStatic(this.constructor,"hexlifyTransaction"),["eth_estimateGas",[method(params.transaction,{from:!0})]];case "getLogs":return params.filter&&null!=params.filter.address&&(params.filter.address=getLowerCase(params.filter.address)),["eth_getLogs",[params.filter]]}return null};
JsonRpcProvider.prototype.perform=function(method,params){return __awaiter(this,void 0,void 0,function(){var args,error_3;return __generator(this,function(_a){switch(_a.label){case 0:args=this.prepareRequest(method,params),null==args&&logger.throwError(method+" not implemented",logger_1.Logger.errors.NOT_IMPLEMENTED,{operation:method}),_a.label=1;case 1:return _a.trys.push([1,3,,4]),[4,this.send(args[0],args[1])];case 2:return[2,_a.sent()];case 3:return error_3=_a.sent(),[2,checkError(method,error_3,
params)];case 4:return[2]}})})};JsonRpcProvider.prototype._startEvent=function(event){"pending"===event.tag&&this._startPending();_super.prototype._startEvent.call(this,event)};JsonRpcProvider.prototype._startPending=function(){if(null==this._pendingFilter){var self=this,pendingFilter=this.send("eth_newPendingTransactionFilter",[]);this._pendingFilter=pendingFilter;pendingFilter.then(function(filterId){function poll(){self.send("eth_getFilterChanges",[filterId]).then(function(hashes){if(self._pendingFilter!=
pendingFilter)return null;var seq=Promise.resolve();hashes.forEach(function(hash){self._emitted["t:"+hash.toLowerCase()]="pending";seq=seq.then(function(){return self.getTransaction(hash).then(function(tx){self.emit("pending",tx);return null})})});return seq.then(function(){return timer(1E3)})}).then(function(){if(self._pendingFilter!=pendingFilter)self.send("eth_uninstallFilter",[filterId]);else return setTimeout(function(){poll()},0),null}).catch(function(error){})}poll();return filterId}).catch(function(error){})}};
JsonRpcProvider.prototype._stopEvent=function(event){"pending"===event.tag&&0===this.listenerCount("pending")&&(this._pendingFilter=null);_super.prototype._stopEvent.call(this,event)};JsonRpcProvider.hexlifyTransaction=function(transaction,allowExtra){var allowed=properties_1.shallowCopy(allowedTransactionKeys);if(allowExtra)for(var key$jscomp$0 in allowExtra)allowExtra[key$jscomp$0]&&(allowed[key$jscomp$0]=!0);properties_1.checkProperties(transaction,allowed);var result={};["gasLimit","gasPrice",
"nonce","value"].forEach(function(key){if(null!=transaction[key]){var value=bytes_1.hexValue(transaction[key]);"gasLimit"===key&&(key="gas");result[key]=value}});["from","to","data"].forEach(function(key){null!=transaction[key]&&(result[key]=bytes_1.hexlify(transaction[key]))});return result};return JsonRpcProvider}(require.BaseProvider);exports.JsonRpcProvider=require}
//# sourceMappingURL=module$node_modules$$ethersproject$providers$lib$json_rpc_provider.js.map
