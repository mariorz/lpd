shadow$provide.module$node_modules$async_mutex$lib$withTimeout=function(global,require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});exports.withTimeout=void 0;var tslib_1=require("module$node_modules$tslib$tslib");exports.withTimeout=function(sync,timeout,timeoutError){var _this=this;void 0===timeoutError&&(timeoutError=Error("timeout"));return{acquire:function(){return new Promise(function(resolve,reject){return tslib_1.__awaiter(_this,void 0,void 0,function(){var isTimeout,
ticket,release;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:return isTimeout=!1,setTimeout(function(){isTimeout=!0;reject(timeoutError)},timeout),[4,sync.acquire()];case 1:return ticket=_a.sent(),isTimeout?(release=Array.isArray(ticket)?ticket[1]:ticket,release()):resolve(ticket),[2]}})})})},runExclusive:function(callback){return tslib_1.__awaiter(this,void 0,void 0,function(){var release,ticket;return tslib_1.__generator(this,function(_a){switch(_a.label){case 0:release=function(){},
_a.label=1;case 1:return _a.trys.push([1,,7,8]),[4,this.acquire()];case 2:ticket=_a.sent();if(!Array.isArray(ticket))return[3,4];release=ticket[1];return[4,callback(ticket[0])];case 3:return[2,_a.sent()];case 4:return release=ticket,[4,callback()];case 5:return[2,_a.sent()];case 6:return[3,8];case 7:return release(),[7];case 8:return[2]}})})},release:function(){sync.release()},isLocked:function(){return sync.isLocked()}}}}
//# sourceMappingURL=module$node_modules$async_mutex$lib$withTimeout.js.map
