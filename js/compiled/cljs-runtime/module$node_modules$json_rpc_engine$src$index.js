shadow$provide.module$node_modules$json_rpc_engine$src$index=function(global,require,module,exports){var SafeEventEmitter=require("module$node_modules$safe_event_emitter$index");global=require("module$node_modules$eth_rpc_errors$index");var serializeError=global.serializeError,EthereumRpcError=global.EthereumRpcError,ERROR_CODES=global.ERROR_CODES,node_modules$json_rpc_engine$src$index$classdecl$var0=function(){var $jscomp$super$this=SafeEventEmitter.call(this)||this;$jscomp$super$this._middleware=
[];return $jscomp$super$this};$jscomp.inherits(node_modules$json_rpc_engine$src$index$classdecl$var0,SafeEventEmitter);node_modules$json_rpc_engine$src$index$classdecl$var0.prototype.push=function(middleware){this._middleware.push(middleware)};node_modules$json_rpc_engine$src$index$classdecl$var0.prototype.handle=function(req,cb){if(Array.isArray(req)){if(cb){this._handleBatch(req).then(function(res){return cb(null,res)}).catch(function(err){return cb(err)});return}return this._handleBatch(req)}return cb?
this._handle(req,cb):this._promiseHandle(req)};node_modules$json_rpc_engine$src$index$classdecl$var0.prototype._handleBatch=function(reqs){var $jscomp$async$this=this;return $jscomp.asyncExecutePromiseGeneratorProgram(function($jscomp$generator$context){return 1==$jscomp$generator$context.nextAddress?$jscomp$generator$context.yield(Promise.all(reqs.map($jscomp$async$this._promiseHandle.bind($jscomp$async$this))),2):$jscomp$generator$context.return($jscomp$generator$context.yieldResult)})};node_modules$json_rpc_engine$src$index$classdecl$var0.prototype._promiseHandle=
function(req){var $jscomp$this=this;return new Promise(function(resolve){$jscomp$this._handle(req,function(_err,res){resolve(res)})})};node_modules$json_rpc_engine$src$index$classdecl$var0.prototype._handle=function(callerReq,cb){callerReq=Object.assign({},callerReq);var res={id:callerReq.id,jsonrpc:callerReq.jsonrpc},processingError;this._processRequest(callerReq,res).catch(function(error){processingError=error}).finally(function(){var responseError=res._originalError;delete res._originalError;if(responseError=
responseError||processingError||null)delete res.result,res.error||(res.error=serializeError(responseError));cb(responseError,res)})};node_modules$json_rpc_engine$src$index$classdecl$var0.prototype._processRequest=function(req,res){var $jscomp$async$this=this,$jscomp$destructuring$var1,isComplete,returnHandlers;return $jscomp.asyncExecutePromiseGeneratorProgram(function($jscomp$generator$context){if(1==$jscomp$generator$context.nextAddress)return $jscomp$generator$context.yield($jscomp$async$this._runAllMiddleware(req,
res),2);$jscomp$destructuring$var1=$jscomp$generator$context.yieldResult;isComplete=$jscomp$destructuring$var1.isComplete;returnHandlers=$jscomp$destructuring$var1.returnHandlers;$jscomp$async$this._checkForCompletion(req,res,isComplete);return $jscomp$generator$context.yield($jscomp$async$this._runReturnHandlers(returnHandlers),0)})};node_modules$json_rpc_engine$src$index$classdecl$var0.prototype._runReturnHandlers=function(handlers){var $jscomp$loop$4,$jscomp$iter$0,$jscomp$key$handler;return $jscomp.asyncExecutePromiseGeneratorProgram(function($jscomp$generator$context){1==
$jscomp$generator$context.nextAddress&&($jscomp$loop$4={},$jscomp$iter$0=$jscomp.makeIterator(handlers),$jscomp$key$handler=$jscomp$iter$0.next());if(3!=$jscomp$generator$context.nextAddress){if($jscomp$key$handler.done)return $jscomp$generator$context.jumpTo(0);$jscomp$loop$4.$jscomp$loop$prop$handler$5=$jscomp$key$handler.value;return $jscomp$generator$context.yield(new Promise(function($jscomp$loop$4){return function(resolve,reject){$jscomp$loop$4.$jscomp$loop$prop$handler$5(function(err){return err?
reject(err):resolve()})}}($jscomp$loop$4)),3)}$jscomp$loop$4={$jscomp$loop$prop$handler$5:$jscomp$loop$4.$jscomp$loop$prop$handler$5};$jscomp$key$handler=$jscomp$iter$0.next();return $jscomp$generator$context.jumpTo(2)})};node_modules$json_rpc_engine$src$index$classdecl$var0.prototype._checkForCompletion=function(req,res,isComplete){if(!("result"in res||"error"in res))throw res=JSON.stringify(req,null,2),new EthereumRpcError(ERROR_CODES.rpc.internal,"JsonRpcEngine: Response has no error or result for request:\n"+
res,req);if(!isComplete)throw res=JSON.stringify(req,null,2),new EthereumRpcError(ERROR_CODES.rpc.internal,"JsonRpcEngine: Nothing ended request:\n"+res,req);};node_modules$json_rpc_engine$src$index$classdecl$var0.prototype._runAllMiddleware=function(req,res){var $jscomp$async$this=this,returnHandlers,isComplete,$jscomp$iter$1,$jscomp$key$middleware,middleware;return $jscomp.asyncExecutePromiseGeneratorProgram(function($jscomp$generator$context){switch($jscomp$generator$context.nextAddress){case 1:returnHandlers=
[],isComplete=!1,$jscomp$iter$1=$jscomp.makeIterator($jscomp$async$this._middleware),$jscomp$key$middleware=$jscomp$iter$1.next();case 2:if($jscomp$key$middleware.done){$jscomp$generator$context.jumpTo(4);break}middleware=$jscomp$key$middleware.value;return $jscomp$generator$context.yield(node_modules$json_rpc_engine$src$index$classdecl$var0._runMiddleware(req,res,middleware,returnHandlers),5);case 5:if(isComplete=$jscomp$generator$context.yieldResult){$jscomp$generator$context.jumpTo(4);break}$jscomp$key$middleware=
$jscomp$iter$1.next();$jscomp$generator$context.jumpTo(2);break;case 4:return $jscomp$generator$context.return({isComplete:isComplete,returnHandlers:returnHandlers.reverse()})}})};node_modules$json_rpc_engine$src$index$classdecl$var0._runMiddleware=function(req,res,middleware,returnHandlers){return new Promise(function(resolve){var end=function(err){if(err=err||res&&res.error)res.error=serializeError(err),res._originalError=err;resolve(!0)},next=function(returnHandler){res.error?end(res.error):(returnHandler&&
returnHandlers.push(returnHandler),resolve(!1))};try{middleware(req,res,next,end)}catch(error){end(error)}})};module.exports=node_modules$json_rpc_engine$src$index$classdecl$var0}
//# sourceMappingURL=module$node_modules$json_rpc_engine$src$index.js.map
