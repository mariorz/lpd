shadow$provide.module$node_modules$await_semaphore$index=function(global,require,module,exports){var process=require("module$node_modules$process$browser");"use strict";class Semaphore{constructor(count){this.tasks=[];this.count=count}sched(){if(0<this.count&&0<this.tasks.length){this.count--;let next=this.tasks.shift();if(void 0===next)throw"Unexpected undefined value in tasks list";next()}}acquire(){return new Promise((res,rej)=>{this.tasks.push(()=>{var released=!1;res(()=>{released||(released=
!0,this.count++,this.sched())})});process&&process.nextTick?process.nextTick(this.sched.bind(this)):setImmediate(this.sched.bind(this))})}use(f){return this.acquire().then(release=>f().then(res=>{release();return res}).catch(err=>{release();throw err;}))}}exports.Semaphore=Semaphore;class Mutex extends Semaphore{constructor(){super(1)}}exports.Mutex=Mutex}
//# sourceMappingURL=module$node_modules$await_semaphore$index.js.map
