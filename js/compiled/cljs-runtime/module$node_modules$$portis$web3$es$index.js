shadow$provide.module$node_modules$$portis$web3$es$index=function(global,require,module,exports){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}global=require("module$node_modules$process$browser");"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _web3ProviderEngine=_interopRequireDefault(require("module$node_modules$web3_provider_engine$index")),_penpal=_interopRequireDefault(require("module$node_modules$penpal$lib$index")),
_networks=require("module$node_modules$$portis$web3$es$networks"),_getTxGas=require("module$node_modules$$portis$web3$es$utils$getTxGas"),_query=require("module$node_modules$$portis$web3$es$utils$query"),_onWindowLoad=require("module$node_modules$$portis$web3$es$utils$onWindowLoad"),_styles=require("module$node_modules$$portis$web3$es$styles"),_secureOrigin=require("module$node_modules$$portis$web3$es$utils$secureOrigin"),_pocketJsCore=_interopRequireDefault(require("module$node_modules$pocket_js_core$src$index")),
__awaiter=function(thisArg,_arguments,P,generator){return new (P||(P=Promise))(function(resolve$jscomp$0,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve$jscomp$0(result.value):(new P(function(resolve){resolve(result.value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=function(thisArg,
body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=
0<t.length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else if(t&&_.label<t[2])_.label=t[2],_.ops.push(op);else{t[2]&&_.ops.pop();_.trys.pop();continue}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),
"throw":verb(1),"return":verb(2)},"function"===typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g},CacheSubprovider=require("module$node_modules$web3_provider_engine$dist$es5$subproviders$cache"),FixtureSubprovider=require("module$node_modules$web3_provider_engine$dist$es5$subproviders$fixture"),FilterSubprovider=require("module$node_modules$web3_provider_engine$dist$es5$subproviders$filters"),HookedWalletSubprovider=require("module$node_modules$web3_provider_engine$dist$es5$subproviders$hooked_wallet"),
NonceSubprovider=require("module$node_modules$web3_provider_engine$dist$es5$subproviders$nonce_tracker"),SubscriptionsSubprovider=require("module$node_modules$web3_provider_engine$dist$es5$subproviders$subscriptions"),WIDGET_URL=global.env.PORTIS_WIDGET_URL||"https://widget.portis.io",SUPPORTED_SCOPES=["email","reputation"];(0,_onWindowLoad.onWindowLoad)().then(function(){document.getElementsByClassName("por_portis-widget-frame").length&&console.warn("Portis script was already loaded. This might cause unexpected behavior. If loading with a \x3cscript\x3e tag, please make sure that you only load it once.")});
require=function(){function Portis(dappId,network,options){void 0===options&&(options={});this._widgetUrl=WIDGET_URL;(0,_secureOrigin.validateSecureOrigin)();this._checkIfWidgetAlreadyInitialized();this._validateParams(dappId,network,options);this.config={dappId,network:(0,_networks.networkAdapter)(network,options.gasRelay),version:"3.0.8",scope:options.scope,registerPageByDefault:options.registerPageByDefault};this.provider=this._initProvider(options)}Portis.prototype.changeNetwork=function(network,
gasRelay){network=(0,_networks.networkAdapter)(network,gasRelay);this.clearSubprovider(NonceSubprovider);this.clearSubprovider(CacheSubprovider);this.config.network=network};Portis.prototype.setDefaultEmail=function(email){this.config.defaultEmail=email};Portis.prototype.getWidget=function(){return __awaiter(this,void 0,void 0,function(){var _a;return __generator(this,function(_b){switch(_b.label){case 0:if(this.widgetInstance)return[3,2];this.widgetPromise||(this.widgetPromise=this._initWidget());
_a=this;return[4,this.widgetPromise];case 1:_a.widgetInstance=_b.sent(),_b.label=2;case 2:return[2,this.widgetInstance]}})})};Portis.prototype.onLogin=function(callback){this._onLoginCallback=callback};Portis.prototype.onLogout=function(callback){this._onLogoutCallback=callback};Portis.prototype.onActiveWalletChanged=function(callback){this._onActiveWalletChangedCallback=callback};Portis.prototype.onError=function(callback){this._onErrorCallback=callback};Portis.prototype.showPortis=function(){return __awaiter(this,
void 0,void 0,function(){var widgetCommunication;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.getWidget()];case 1:return widgetCommunication=_a.sent().communication,[2,widgetCommunication.showPortis(this.config)]}})})};Portis.prototype.logout=function(){return __awaiter(this,void 0,void 0,function(){var widgetCommunication;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.getWidget()];case 1:return widgetCommunication=_a.sent().communication,
[2,widgetCommunication.logout()]}})})};Portis.prototype.getExtendedPublicKey=function(path,coin){void 0===path&&(path="m/44'/60'/0'/0/0");void 0===coin&&(coin="Ethereum");return __awaiter(this,void 0,void 0,function(){var widgetCommunication;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.getWidget()];case 1:return widgetCommunication=_a.sent().communication,[2,widgetCommunication.getExtendedPublicKey(path,coin,this.config)]}})})};Portis.prototype.importWallet=function(mnemonicOrPrivateKey){return __awaiter(this,
void 0,void 0,function(){var widgetCommunication;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.getWidget()];case 1:return widgetCommunication=_a.sent().communication,[2,widgetCommunication.importWallet(mnemonicOrPrivateKey,this.config)]}})})};Portis.prototype.isLoggedIn=function(){return __awaiter(this,void 0,void 0,function(){var widgetCommunication;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.getWidget()];case 1:return widgetCommunication=
_a.sent().communication,[2,widgetCommunication.isLoggedIn()]}})})};Portis.prototype.signBitcoinTransaction=function(params){return __awaiter(this,void 0,void 0,function(){var widgetCommunication;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.getWidget()];case 1:return widgetCommunication=_a.sent().communication,[2,widgetCommunication.signBitcoinTransaction(params,this.config)]}})})};Portis.prototype.showBitcoinWallet=function(path){void 0===path&&(path="m/49'/0'/0'/0/0");
return __awaiter(this,void 0,void 0,function(){var widgetCommunication;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.getWidget()];case 1:return widgetCommunication=_a.sent().communication,[2,widgetCommunication.showBitcoinWallet(path,this.config)]}})})};Portis.prototype._checkIfWidgetAlreadyInitialized=function(){document.getElementsByClassName("por_portis-container").length&&console.warn("An instance of Portis was already initialized. This is probably a mistake. Make sure that you use the same Portis instance throughout your app.")};
Portis.prototype._validateParams=function(dappId,network,options){if(!dappId)throw Error("[Portis] 'dappId' is required. Get your dappId here: https://dashboard.portis.io");if(!network)throw Error("[Portis] 'network' is required. Read more about it here: https://docs.portis.io/#/configuration?id\x3dnetwork");if(options.scope){if(!Array.isArray(options.scope))throw Error("[Portis] 'scope' must be an array. Read more about it here: https://docs.portis.io/#/configuration?id\x3dscope");if(0<options.scope.filter(function(item){return 0>
SUPPORTED_SCOPES.indexOf(item)}).length)throw Error("[Portis] invalid 'scope' parameter. Read more about it here: https://docs.portis.io/#/configuration?id\x3dscope");}if(void 0!==options.registerPageByDefault&&"boolean"!==typeof options.registerPageByDefault)throw Error("[Portis] invalid 'registerPageByDefault' parameter, must be a boolean. Read more about it here: https://docs.portis.io/#/configuration?id\x3dregisterPageByDefault");options.staging&&(console.warn("Please note: you are using the Portis STAGING environment."),
this._widgetUrl="https://widget-staging.portis.io")};Portis.prototype._initWidget=function(){return __awaiter(this,void 0,void 0,function(){var style,container,widgetFrame,connection,communication;return __generator(this,function(_a){switch(_a.label){case 0:return[4,(0,_onWindowLoad.onWindowLoad)()];case 1:return _a.sent(),style=document.createElement("style"),style.innerHTML=_styles.styles,container=document.createElement("div"),container.className="por_portis-container",widgetFrame=document.createElement("div"),
widgetFrame.id="portis-container-"+Date.now(),widgetFrame.className="por_portis-widget-frame",container.appendChild(widgetFrame),document.body.appendChild(container),document.head.appendChild(style),connection=_penpal["default"].connectToChild({url:this._widgetUrl,appendTo:document.getElementById(widgetFrame.id),methods:{setHeight:this._setHeight.bind(this),getWindowSize:this._getWindowSize.bind(this),onLogin:this._onLogin.bind(this),onLogout:this._onLogout.bind(this),onActiveWalletChanged:this._onActiveWalletChanged.bind(this),
onError:this._onError.bind(this)}}),[4,connection.promise];case 2:return communication=_a.sent(),communication.setSdkConfig(this.config),connection.iframe.style.position="absolute",connection.iframe.style.height="100%",connection.iframe.style.width="100%",connection.iframe.style.border="0 transparent",[2,{communication,widgetFrame}]}})})};Portis.prototype._initProvider=function(options){var _this=this;if(this.engine)return this.engine;this.engine=new _web3ProviderEngine["default"];var query=new _query.Query(this.engine);
this.engine.send=function(payload,callback){if("string"===typeof payload)return new Promise(function(resolve,reject){_this.engine.sendAsync({jsonrpc:"2.0",id:42,method:payload,params:callback||[]},function(error,response){error?reject(error):resolve(response.result)})});if(callback)_this.engine.sendAsync(payload,callback);else{var result=null;switch(payload.method){case "eth_accounts":result=_this._selectedAddress?[_this._selectedAddress]:[];break;case "eth_coinbase":result=_this._selectedAddress?
[_this._selectedAddress]:[];break;case "net_version":result=_this._network;break;case "eth_uninstallFilter":_this.engine.sendAsync(payload,function(_){return _});result=!0;break;default:throw Error("The Portis Web3 object does not support synchronous methods like "+payload.method+" without a callback parameter.");}return{id:payload.id,jsonrpc:payload.jsonrpc,result}}};this.engine.addProvider(new FixtureSubprovider({web3_clientVersion:"Portis/v"+this.config.version+"/javascript",net_listening:!0,eth_hashrate:"0x00",
eth_mining:!1,eth_syncing:!0}));this.engine.addProvider(new CacheSubprovider);this.engine.addProvider(new SubscriptionsSubprovider);this.engine.addProvider(new FilterSubprovider);this.engine.addProvider(new NonceSubprovider);this.engine.addProvider({setEngine:function(_){return _},handleRequest:function(payload,next,end){return __awaiter(_this,void 0,void 0,function(){return __generator(this,function(_a){payload.id||(payload.id=42);next();return[2]})})}});this.engine.addProvider(new HookedWalletSubprovider({getAccounts:function(cb){return __awaiter(_this,
void 0,void 0,function(){var widgetCommunication,_a,error,result;return __generator(this,function(_b){switch(_b.label){case 0:return[4,this.getWidget()];case 1:return widgetCommunication=_b.sent().communication,[4,widgetCommunication.getAccounts(this.config)];case 2:return _a=_b.sent(),error=_a.error,result=_a.result,!error&&result&&(this._selectedAddress=result[0]),cb(error,result),[2]}})})},signTransaction:function(txParams,cb){return __awaiter(_this,void 0,void 0,function(){var widgetCommunication,
_a,error,result;return __generator(this,function(_b){switch(_b.label){case 0:return[4,this.getWidget()];case 1:return widgetCommunication=_b.sent().communication,[4,widgetCommunication.signTransaction(txParams,this.config)];case 2:return _a=_b.sent(),error=_a.error,result=_a.result,cb(error,result),[2]}})})},signMessage:function(msgParams,cb){return __awaiter(_this,void 0,void 0,function(){var widgetCommunication,params,_a,error,result;return __generator(this,function(_b){switch(_b.label){case 0:return[4,
this.getWidget()];case 1:return widgetCommunication=_b.sent().communication,params=Object.assign({},msgParams,{messageStandard:"signMessage"}),[4,widgetCommunication.signMessage(params,this.config)];case 2:return _a=_b.sent(),error=_a.error,result=_a.result,cb(error,result),[2]}})})},signPersonalMessage:function(msgParams,cb){return __awaiter(_this,void 0,void 0,function(){var widgetCommunication,params,_a,error,result;return __generator(this,function(_b){switch(_b.label){case 0:return[4,this.getWidget()];
case 1:return widgetCommunication=_b.sent().communication,params=Object.assign({},msgParams,{messageStandard:"signPersonalMessage"}),[4,widgetCommunication.signMessage(params,this.config)];case 2:return _a=_b.sent(),error=_a.error,result=_a.result,cb(error,result),[2]}})})},signTypedMessage:function(msgParams,cb){return __awaiter(_this,void 0,void 0,function(){var widgetCommunication,params,_a,error,result;return __generator(this,function(_b){switch(_b.label){case 0:return[4,this.getWidget()];case 1:return widgetCommunication=
_b.sent().communication,params=Object.assign({},msgParams,{messageStandard:"signTypedMessage"}),[4,widgetCommunication.signMessage(params,this.config)];case 2:return _a=_b.sent(),error=_a.error,result=_a.result,cb(error,result),[2]}})})},signTypedMessageV3:function(msgParams,cb){return __awaiter(_this,void 0,void 0,function(){var widgetCommunication,params,_a,error,result;return __generator(this,function(_b){switch(_b.label){case 0:return[4,this.getWidget()];case 1:return widgetCommunication=_b.sent().communication,
params=Object.assign({},msgParams,{messageStandard:"signTypedMessageV3"}),[4,widgetCommunication.signMessage(params,this.config)];case 2:return _a=_b.sent(),error=_a.error,result=_a.result,cb(error,result),[2]}})})},estimateGas:function(txParams,cb){return __awaiter(_this,void 0,void 0,function(){var gas;return __generator(this,function(_a){switch(_a.label){case 0:return[4,(0,_getTxGas.getTxGas)(query,txParams)];case 1:return gas=_a.sent(),cb(null,gas),[2]}})})},getGasPrice:function(cb){return __awaiter(_this,
void 0,void 0,function(){return __generator(this,function(_a){cb(null,"");return[2]})})}}));if(options.pocketDevId){var pocket_1=new _pocketJsCore["default"].Pocket({devID:options.pocketDevId,networkName:"ETH",netIDs:[this.config.network.chainId]});this.engine.addProvider({setEngine:function(_){return _},handleRequest:function(payload,next,end){return __awaiter(_this,void 0,void 0,function(){var response,result,error;return __generator(this,function(_a){switch(_a.label){case 0:return[4,pocket_1.sendRelay(new _pocketJsCore["default"].Relay("ETH",
this.config.network.chainId,JSON.stringify(payload),pocket_1.configuration))];case 1:response=_a.sent();if(response instanceof Error||!response)error=response||Error("Unknown error"),result=null;else try{result=JSON.parse(response).result,error=null}catch(e){result=null,error=e}"net_version"===payload.method&&(this._network=result,this.engine.networkVersion=this._network);end(error,result);return[2]}})})}})}else this.engine.addProvider({setEngine:function(_){return _},handleRequest:function(payload,
next,end){return __awaiter(_this,void 0,void 0,function(){var widgetCommunication,_a,error,result;return __generator(this,function(_b){switch(_b.label){case 0:return[4,this.getWidget()];case 1:return widgetCommunication=_b.sent().communication,[4,widgetCommunication.relay(payload,this.config)];case 2:return _a=_b.sent(),error=_a.error,result=_a.result,"net_version"===payload.method&&(this._network=result,this.engine.networkVersion=this._network),end(error,result),[2]}})})}});this.engine.enable=function(){return new Promise(function(resolve,
reject){_this.engine.sendAsync({method:"eth_accounts"},function(error,response){error?reject(error):resolve(response.result)})})};this.engine.isConnected=function(){return!0};this.engine.isPortis=!0;this.engine.on("error",function(error){error&&error.message&&error.message.includes("PollingBlockTracker")?console.warn("If you see this warning constantly, there might be an error with your RPC node."):console.error(error)});this.engine.start();return this.engine};Portis.prototype._setHeight=function(height){return __awaiter(this,
void 0,void 0,function(){var widgetFrame;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.getWidget()];case 1:return widgetFrame=_a.sent().widgetFrame,widgetFrame.style.height=height+"px",[2]}})})};Portis.prototype._getWindowSize=function(){var body=document.getElementsByTagName("body")[0];return{width:window.innerWidth||document.documentElement.clientWidth||body.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||body.clientHeight}};Portis.prototype._onLogin=
function(walletAddress,email,reputation){this._onLoginCallback&&this._onLoginCallback(walletAddress,email,reputation)};Portis.prototype._onLogout=function(){this._selectedAddress="";this._onLogoutCallback&&this._onLogoutCallback()};Portis.prototype._onActiveWalletChanged=function(walletAddress){this._onActiveWalletChangedCallback&&this._onActiveWalletChangedCallback(walletAddress)};Portis.prototype._onError=function(error){this._onErrorCallback&&this._onErrorCallback(error)};Portis.prototype.clearSubprovider=
function(subproviderType){var subprovider$jscomp$0=this.provider._providers.find(function(subprovider){return subprovider instanceof subproviderType});this.provider.removeProvider(subprovider$jscomp$0);this.provider.addProvider(new subproviderType)};return Portis}();exports["default"]=require}
//# sourceMappingURL=module$node_modules$$portis$web3$es$index.js.map
