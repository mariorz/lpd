shadow$provide.module$node_modules$leaflet_vega$dist$bundle=function(global$jscomp$0,require,module,exports){(function(global,factory){"object"===typeof exports&&"undefined"!==typeof module?factory(require("module$node_modules$leaflet$dist$leaflet_src")):"function"===typeof define&&define.amd?define(["leaflet"],factory):factory(global.L)})(this,function(L){L=L&&L.hasOwnProperty("default")?L["default"]:L;var _class=function(){function _class(onWarning){if(!(this instanceof _class))throw new TypeError("Cannot call a class as a function");
this.onWarning=onWarning||(console?console.log:function(){})}_class.prototype.addToList=function(spec,field,values){values=new Map(values.map(function(v){return"string"===typeof v?[v,{name:v}]:[v.name,v]}));var _iterator=this.findUndefined(spec,field,values.keys()),_isArray=Array.isArray(_iterator),_i=0;for(_iterator=_isArray?_iterator:_iterator[Symbol.iterator]();;){if(_isArray){if(_i>=_iterator.length)break;var _ref=_iterator[_i++]}else{_i=_iterator.next();if(_i.done)break;_ref=_i.value}spec[field].push(values.get(_ref))}return spec};
_class.prototype.overrideField=function(spec,field,value){if(spec[field]&&spec[field]!==value)this.onWarning("Overriding "+field+": "+spec[field]+" \ud800\udcd8 "+value);spec[field]=value;return spec};_class.prototype.findUndefined=function(spec,section,names){if(!spec.hasOwnProperty(section))return spec[section]=[],names;if(!Array.isArray(spec[section]))throw Error("spec."+section+" must be an array");names=new Set(names);spec=spec[section];section=Array.isArray(spec);var _i2=0;for(spec=section?
spec:spec[Symbol.iterator]();;){if(section){if(_i2>=spec.length)break;var _ref2=spec[_i2++]}else{_i2=spec.next();if(_i2.done)break;_ref2=_i2.value}_ref2.name&&names.delete(_ref2.name)}return names};return _class}(),asyncToGenerator=function(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg),value$jscomp$0=info.value}catch(error){reject(error);return}if(info.done)resolve(value$jscomp$0);else return Promise.resolve(value$jscomp$0).then(function(value){step("next",
value)},function(err){step("throw",err)})}return step("next")})}},slicedToArray=function(){return function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr)){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&_i["return"])_i["return"]()}finally{if(_d)throw _e;}}return _arr}throw new TypeError("Invalid attempt to destructure non-iterable instance");
}}();L.vega=function(spec,options){return new L.VegaLayer(spec,options)};L.VegaLayer=(L.Layer?L.Layer:L.Class).extend({options:{vega:window&&window.vega,bindingsContainer:void 0,parseConfig:void 0,viewConfig:void 0,delayRepaint:!0,onWarning:!1,onError:!1},initialize:function(spec,options){var _this=this;L.Util.setOptions(this,options);var vega=this.options.vega;vega.expressionFunction("setMapView")||vega.expressionFunction("setMapView",function(){for(var _len=arguments.length,args=Array(_len),_key=
0;_key<_len;_key++)args[_key]=arguments[_key];_len=this.context.dataflow;var handler=_len.Leaflet_setMapViewHandler;if(!handler)throw Error("setMapView() is not defined for this graph");_len.runAfter(function(){return handler.apply(void 0,args)})});this._ignoreSignals=0;this.disableSignals=function(){_this._ignoreSignals++};this.enableSignals=function(){_this._ignoreSignals--;if(0>_this._ignoreSignals)throw _this._ignoreSignals=0,Error("Too many calls to enableSignals()");};options=new _class(options.onWarning);
options.overrideField(spec,"padding",0);options.overrideField(spec,"autosize","none");options.addToList(spec,"signals",["zoom","latitude","longitude"]);options.addToList(spec,"projections",[this.defaultProjection]);this._spec=spec},addTo:function(map){map.addLayer(this);return this},onAdd:function(map){this._onAddAsync(map);return this},_onAddAsync:function(map){var _this2=this;return asyncToGenerator(regeneratorRuntime.mark(function _callee(){var _options,vega,viewConfig,dataflow,oldLoad,onSignal;
return regeneratorRuntime.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _this2.disableSignals(),_context.prev=1,_this2._map=map,_this2._vegaContainer=L.DomUtil.create("div","leaflet-vega-container"),map._panes.overlayPane.appendChild(_this2._vegaContainer),_options=_this2.options,vega=_options.vega,viewConfig=_options.viewConfig,dataflow=vega.parse(_this2._spec,_this2.options.parseConfig),viewConfig&&viewConfig.loader&&(oldLoad=viewConfig.loader.load.bind(viewConfig.loader),
viewConfig.loader.load=function(uri,opt){return oldLoad(uri,opt)}),_this2._view=new vega.View(dataflow,viewConfig),viewConfig&&void 0!==viewConfig.logLevel||_this2._view.logLevel(vega.Warn),_this2.options.onWarning&&(_this2._view.warn=_this2.options.onWarning),_this2.options.onError&&(_this2._view.error=_this2.options.onError),_this2._view.padding({left:0,right:0,top:0,bottom:0}).initialize(_this2._vegaContainer,_this2.options.bindingsContainer).hover(),onSignal=function(sig,value){return _this2._onSignalChange(sig,
value)},_this2._view.addSignalListener("latitude",onSignal).addSignalListener("longitude",onSignal).addSignalListener("zoom",onSignal),map.on(_this2.options.delayRepaint?"moveend":"move",function(){return _this2._resetAsync()}),map.on("zoomend",function(){return _this2._resetAsync()}),_this2._view.Leaflet_setMapViewHandler=function(){function throwError(){throw Error("Unexpected setMapView() parameters. It could be called with a bounding box setMapView([[longitude1,latitude1],[longitude2,latitude2]]), or it could be the center point setMapView([longitude, latitude], optional_zoom), or it can be used as setMapView(latitude, longitude, optional_zoom)");
}function checkArray(val){Array.isArray(val)&&2===val.length&&"number"===typeof val[0]&&"number"===typeof val[1]||throwError();return val}for(var _len2=arguments.length,args=Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];var lat=_len2=void 0;_key2=void 0;switch(args.length){default:throwError();break;case 1:var arg=args[0];if(Array.isArray(arg)&&2===arg.length&&Array.isArray(arg[0])&&Array.isArray(arg[1])){args=checkArray(arg[0]);var _checkArray2=slicedToArray(args,2);args=
_checkArray2[0];_checkArray2=_checkArray2[1];arg=checkArray(arg[1]);var _checkArray4=slicedToArray(arg,2);arg=_checkArray4[0];_checkArray4=_checkArray4[1];map.fitBounds(L.latLngBounds(L.latLng(_checkArray2,args),L.latLng(_checkArray4,arg)))}else _len2=checkArray(arg),lat=slicedToArray(_len2,2),_len2=lat[0],lat=lat[1];break;case 2:Array.isArray(args[0])?(_len2=checkArray(args[0]),_key2=slicedToArray(_len2,2),_len2=_key2[0],lat=_key2[1],_key2=args[1]):(lat=args[0],_len2=args[1]);break;case 3:lat=args[0],
_len2=args[1],_key2=args[2]}void 0!==lat&&void 0!==_len2&&("number"===typeof lat&&"number"===typeof _len2||throwError(),void 0===_key2?_key2=map.getZoom():"number"!==typeof _key2&&throwError(),map.setView({lat,lng:_len2},_key2))},_context.next=20,_this2._resetAsync(!0);case 20:_context.next=25;break;case 22:_context.prev=22,_context.t0=_context["catch"](1),_this2._reportError(_context.t0);case 25:return _context.prev=25,_this2.enableSignals(),_context.finish(25);case 28:case "end":return _context.stop()}},
_callee,_this2,[[1,22,25,28]])}))()},onRemove:function(){this._view&&(this._view.finalize(),this._view=null);for(var el=this._vegaContainer;el.firstChild;)el.removeChild(el.firstChild)},_reportError:function(err){if(this.options.onError)this.options.onError(err);else console&&console.error&&console.error(err)},_onSignalChange:function(sig,value){if(!this._ignoreSignals)try{var map=this._map,center=map.getCenter(),zoom=map.getZoom();switch(sig){case "latitude":center.lat=value;break;case "longitude":center.lng=
value;break;case "zoom":zoom=value;break;default:return}map.setView(center,zoom)}catch(err){this._reportError(err)}},_resetAsync:function(force){var _this3=this;return asyncToGenerator(regeneratorRuntime.mark(function _callee2(){var map,view,topLeft,size,center,zoom,sendSignal,changed;return regeneratorRuntime.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(_this3._view){_context2.next=2;break}return _context2.abrupt("return");case 2:_this3.disableSignals();_context2.prev=
3;map=_this3._map;view=_this3._view;topLeft=map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(_this3._vegaContainer,topLeft);size=map.getSize();center=map.getCenter();zoom=map.getZoom();sendSignal=function(sig,value){return view.signal(sig)!==value?(view.signal(sig,value),1):0};changed=sendSignal("width",size.x)+sendSignal("height",size.y)+sendSignal("latitude",center.lat)+sendSignal("longitude",center.lng)+sendSignal("zoom",zoom);if(!(0<changed||force)){_context2.next=16;break}_context2.next=
16;return view.runAsync();case 16:_context2.next=21;break;case 18:_context2.prev=18,_context2.t0=_context2["catch"](3),_this3._reportError(_context2.t0);case 21:return _context2.prev=21,_this3.enableSignals(),_context2.finish(21);case 24:case "end":return _context2.stop()}},_callee2,_this3,[[3,18,21,24]])}))()},defaultProjection:{name:"projection",type:"mercator",scale:{signal:"256*pow(2,zoom)/2/PI"},rotate:[{signal:"-longitude"},0,0],center:[0,{signal:"latitude"}],translate:[{signal:"width/2"},{signal:"height/2"}],
fit:!1}});L.VegaLayer.version="0.8.6"})}
//# sourceMappingURL=module$node_modules$leaflet_vega$dist$bundle.js.map
