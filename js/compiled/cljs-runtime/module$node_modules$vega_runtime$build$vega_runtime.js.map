{
"version":3,
"file":"module$node_modules$vega_runtime$build$vega_runtime.js",
"lineCount":23,
"mappings":"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",
"sources":["node_modules/vega-runtime/build/vega-runtime.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$vega_runtime$build$vega_runtime\"] = function(global,require,module,exports) {\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('vega-util'), require('vega-dataflow')) :\n  typeof define === 'function' && define.amd ? define(['exports', 'vega-util', 'vega-dataflow'], factory) :\n  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.vega = {}, global.vega, global.vega));\n}(this, (function (exports, vegaUtil, vegaDataflow) { 'use strict';\n\n  /**\n   * Parse a serialized dataflow specification.\n   */\n  function parse (spec) {\n    const ctx = this,\n          operators = spec.operators || []; // parse background\n\n    if (spec.background) {\n      ctx.background = spec.background;\n    } // parse event configuration\n\n\n    if (spec.eventConfig) {\n      ctx.eventConfig = spec.eventConfig;\n    } // parse locale configuration\n\n\n    if (spec.locale) {\n      ctx.locale = spec.locale;\n    } // parse operators\n\n\n    operators.forEach(entry => ctx.parseOperator(entry)); // parse operator parameters\n\n    operators.forEach(entry => ctx.parseOperatorParameters(entry)); // parse streams\n\n    (spec.streams || []).forEach(entry => ctx.parseStream(entry)); // parse updates\n\n    (spec.updates || []).forEach(entry => ctx.parseUpdate(entry));\n    return ctx.resolve();\n  }\n\n  const Skip = vegaUtil.toSet(['rule']),\n        Swap = vegaUtil.toSet(['group', 'image', 'rect']);\n  function adjustSpatial(encode, marktype) {\n    let code = '';\n    if (Skip[marktype]) return code;\n\n    if (encode.x2) {\n      if (encode.x) {\n        if (Swap[marktype]) {\n          code += 'if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;';\n        }\n\n        code += 'o.width=o.x2-o.x;';\n      } else {\n        code += 'o.x=o.x2-(o.width||0);';\n      }\n    }\n\n    if (encode.xc) {\n      code += 'o.x=o.xc-(o.width||0)/2;';\n    }\n\n    if (encode.y2) {\n      if (encode.y) {\n        if (Swap[marktype]) {\n          code += 'if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;';\n        }\n\n        code += 'o.height=o.y2-o.y;';\n      } else {\n        code += 'o.y=o.y2-(o.height||0);';\n      }\n    }\n\n    if (encode.yc) {\n      code += 'o.y=o.yc-(o.height||0)/2;';\n    }\n\n    return code;\n  }\n  function canonicalType(type) {\n    return (type + '').toLowerCase();\n  }\n  function isOperator(type) {\n    return canonicalType(type) === 'operator';\n  }\n  function isCollect(type) {\n    return canonicalType(type) === 'collect';\n  }\n\n  function expression(ctx, args, code) {\n    // wrap code in return statement if expression does not terminate\n    if (code[code.length - 1] !== ';') {\n      code = 'return(' + code + ');';\n    }\n\n    const fn = Function(...args.concat(code));\n    return ctx && ctx.functions ? fn.bind(ctx.functions) : fn;\n  } // generate code for comparing a single field\n\n\n  function _compare(u, v, lt, gt) {\n    return `((u = ${u}) < (v = ${v}) || u == null) && v != null ? ${lt}\n  : (u > v || v == null) && u != null ? ${gt}\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${lt}\n  : v !== v && u === u ? ${gt} : `;\n  }\n\n  var expressionCodegen = {\n    /**\n     * Parse an expression used to update an operator value.\n     */\n    operator: (ctx, expr) => expression(ctx, ['_'], expr.code),\n\n    /**\n     * Parse an expression provided as an operator parameter value.\n     */\n    parameter: (ctx, expr) => expression(ctx, ['datum', '_'], expr.code),\n\n    /**\n     * Parse an expression applied to an event stream.\n     */\n    event: (ctx, expr) => expression(ctx, ['event'], expr.code),\n\n    /**\n     * Parse an expression used to handle an event-driven operator update.\n     */\n    handler: (ctx, expr) => {\n      const code = `var datum=event.item&&event.item.datum;return ${expr.code};`;\n      return expression(ctx, ['_', 'event'], code);\n    },\n\n    /**\n     * Parse an expression that performs visual encoding.\n     */\n    encode: (ctx, encode) => {\n      const {\n        marktype,\n        channels\n      } = encode;\n      let code = 'var o=item,datum=o.datum,m=0,$;';\n\n      for (const name in channels) {\n        const o = 'o[' + vegaUtil.stringValue(name) + ']';\n        code += `$=${channels[name].code};if(${o}!==$)${o}=$,m=1;`;\n      }\n\n      code += adjustSpatial(channels, marktype);\n      code += 'return m;';\n      return expression(ctx, ['item', '_'], code);\n    },\n\n    /**\n     * Optimized code generators for access and comparison.\n     */\n    codegen: {\n      get(path) {\n        const ref = `[${path.map(vegaUtil.stringValue).join('][')}]`;\n        const get = Function('_', `return _${ref};`);\n        get.path = ref;\n        return get;\n      },\n\n      comparator(fields, orders) {\n        let t;\n\n        const map = (f, i) => {\n          const o = orders[i];\n          let u, v;\n\n          if (f.path) {\n            u = `a${f.path}`;\n            v = `b${f.path}`;\n          } else {\n            (t = t || {})['f' + i] = f;\n            u = `this.f${i}(a)`;\n            v = `this.f${i}(b)`;\n          }\n\n          return _compare(u, v, -o, o);\n        };\n\n        const fn = Function('a', 'b', 'var u, v; return ' + fields.map(map).join('') + '0;');\n        return t ? fn.bind(t) : fn;\n      }\n\n    }\n  };\n\n  /**\n   * Parse a dataflow operator.\n   */\n\n  function parseOperator(spec) {\n    const ctx = this;\n\n    if (isOperator(spec.type) || !spec.type) {\n      ctx.operator(spec, spec.update ? ctx.operatorExpression(spec.update) : null);\n    } else {\n      ctx.transform(spec, spec.type);\n    }\n  }\n  /**\n   * Parse and assign operator parameters.\n   */\n\n  function parseOperatorParameters(spec) {\n    const ctx = this;\n\n    if (spec.params) {\n      const op = ctx.get(spec.id);\n      if (!op) vegaUtil.error('Invalid operator id: ' + spec.id);\n      ctx.dataflow.connect(op, op.parameters(ctx.parseParameters(spec.params), spec.react, spec.initonly));\n    }\n  }\n\n  /**\n   * Parse a set of operator parameters.\n   */\n\n  function parseParameters(spec, params) {\n    params = params || {};\n    const ctx = this;\n\n    for (const key in spec) {\n      const value = spec[key];\n      params[key] = vegaUtil.isArray(value) ? value.map(v => parseParameter(v, ctx, params)) : parseParameter(value, ctx, params);\n    }\n\n    return params;\n  }\n  /**\n   * Parse a single parameter.\n   */\n\n  function parseParameter(spec, ctx, params) {\n    if (!spec || !vegaUtil.isObject(spec)) return spec;\n\n    for (let i = 0, n = PARSERS.length, p; i < n; ++i) {\n      p = PARSERS[i];\n\n      if (vegaUtil.hasOwnProperty(spec, p.key)) {\n        return p.parse(spec, ctx, params);\n      }\n    }\n\n    return spec;\n  }\n  /** Reference parsers. */\n\n\n  var PARSERS = [{\n    key: '$ref',\n    parse: getOperator\n  }, {\n    key: '$key',\n    parse: getKey\n  }, {\n    key: '$expr',\n    parse: getExpression\n  }, {\n    key: '$field',\n    parse: getField\n  }, {\n    key: '$encode',\n    parse: getEncode\n  }, {\n    key: '$compare',\n    parse: getCompare\n  }, {\n    key: '$context',\n    parse: getContext\n  }, {\n    key: '$subflow',\n    parse: getSubflow\n  }, {\n    key: '$tupleid',\n    parse: getTupleId\n  }];\n  /**\n   * Resolve an operator reference.\n   */\n\n  function getOperator(_, ctx) {\n    return ctx.get(_.$ref) || vegaUtil.error('Operator not defined: ' + _.$ref);\n  }\n  /**\n   * Resolve an expression reference.\n   */\n\n\n  function getExpression(_, ctx, params) {\n    if (_.$params) {\n      // parse expression parameters\n      ctx.parseParameters(_.$params, params);\n    }\n\n    const k = 'e:' + _.$expr.code + '_' + _.$name;\n    return ctx.fn[k] || (ctx.fn[k] = vegaUtil.accessor(ctx.parameterExpression(_.$expr), _.$fields, _.$name));\n  }\n  /**\n   * Resolve a key accessor reference.\n   */\n\n\n  function getKey(_, ctx) {\n    const k = 'k:' + _.$key + '_' + !!_.$flat;\n    return ctx.fn[k] || (ctx.fn[k] = vegaUtil.key(_.$key, _.$flat, ctx.expr.codegen));\n  }\n  /**\n   * Resolve a field accessor reference.\n   */\n\n\n  function getField(_, ctx) {\n    if (!_.$field) return null;\n    const k = 'f:' + _.$field + '_' + _.$name;\n    return ctx.fn[k] || (ctx.fn[k] = vegaUtil.field(_.$field, _.$name, ctx.expr.codegen));\n  }\n  /**\n   * Resolve a comparator function reference.\n   */\n\n\n  function getCompare(_, ctx) {\n    // As of Vega 5.5.3, $tupleid sort is no longer used.\n    // Keep here for now for backwards compatibility.\n    const k = 'c:' + _.$compare + '_' + _.$order,\n          c = vegaUtil.array(_.$compare).map(_ => _ && _.$tupleid ? vegaDataflow.tupleid : _);\n    return ctx.fn[k] || (ctx.fn[k] = vegaUtil.compare(c, _.$order, ctx.expr.codegen));\n  }\n  /**\n   * Resolve an encode operator reference.\n   */\n\n\n  function getEncode(_, ctx) {\n    const spec = _.$encode,\n          encode = {};\n\n    for (const name in spec) {\n      const enc = spec[name];\n      encode[name] = vegaUtil.accessor(ctx.encodeExpression(enc.$expr), enc.$fields);\n      encode[name].output = enc.$output;\n    }\n\n    return encode;\n  }\n  /**\n   * Resolve a context reference.\n   */\n\n\n  function getContext(_, ctx) {\n    return ctx;\n  }\n  /**\n   * Resolve a recursive subflow specification.\n   */\n\n\n  function getSubflow(_, ctx) {\n    const spec = _.$subflow;\n    return function (dataflow, key, parent) {\n      const subctx = ctx.fork().parse(spec),\n            op = subctx.get(spec.operators[0].id),\n            p = subctx.signals.parent;\n      if (p) p.set(parent);\n\n      op.detachSubflow = () => ctx.detach(subctx);\n\n      return op;\n    };\n  }\n  /**\n   * Resolve a tuple id reference.\n   */\n\n\n  function getTupleId() {\n    return vegaDataflow.tupleid;\n  }\n\n  /**\n   * Parse an event stream specification.\n   */\n\n  function parseStream (spec) {\n    var ctx = this,\n        filter = spec.filter != null ? ctx.eventExpression(spec.filter) : undefined,\n        stream = spec.stream != null ? ctx.get(spec.stream) : undefined,\n        args;\n\n    if (spec.source) {\n      stream = ctx.events(spec.source, spec.type, filter);\n    } else if (spec.merge) {\n      args = spec.merge.map(_ => ctx.get(_));\n      stream = args[0].merge.apply(args[0], args.slice(1));\n    }\n\n    if (spec.between) {\n      args = spec.between.map(_ => ctx.get(_));\n      stream = stream.between(args[0], args[1]);\n    }\n\n    if (spec.filter) {\n      stream = stream.filter(filter);\n    }\n\n    if (spec.throttle != null) {\n      stream = stream.throttle(+spec.throttle);\n    }\n\n    if (spec.debounce != null) {\n      stream = stream.debounce(+spec.debounce);\n    }\n\n    if (stream == null) {\n      vegaUtil.error('Invalid stream definition: ' + JSON.stringify(spec));\n    }\n\n    if (spec.consume) stream.consume(true);\n    ctx.stream(spec, stream);\n  }\n\n  /**\n   * Parse an event-driven operator update.\n   */\n\n  function parseUpdate (spec) {\n    var ctx = this,\n        srcid = vegaUtil.isObject(srcid = spec.source) ? srcid.$ref : srcid,\n        source = ctx.get(srcid),\n        target = null,\n        update = spec.update,\n        params = undefined;\n    if (!source) vegaUtil.error('Source not defined: ' + spec.source);\n    target = spec.target && spec.target.$expr ? ctx.eventExpression(spec.target.$expr) : ctx.get(spec.target);\n\n    if (update && update.$expr) {\n      if (update.$params) {\n        params = ctx.parseParameters(update.$params);\n      }\n\n      update = ctx.handlerExpression(update.$expr);\n    }\n\n    ctx.update(spec, source, target, update, params);\n  }\n\n  const SKIP = {\n    skip: true\n  };\n  function getState(options) {\n    var ctx = this,\n        state = {};\n\n    if (options.signals) {\n      var signals = state.signals = {};\n      Object.keys(ctx.signals).forEach(key => {\n        const op = ctx.signals[key];\n\n        if (options.signals(key, op)) {\n          signals[key] = op.value;\n        }\n      });\n    }\n\n    if (options.data) {\n      var data = state.data = {};\n      Object.keys(ctx.data).forEach(key => {\n        const dataset = ctx.data[key];\n\n        if (options.data(key, dataset)) {\n          data[key] = dataset.input.value;\n        }\n      });\n    }\n\n    if (ctx.subcontext && options.recurse !== false) {\n      state.subcontext = ctx.subcontext.map(ctx => ctx.getState(options));\n    }\n\n    return state;\n  }\n  function setState(state) {\n    var ctx = this,\n        df = ctx.dataflow,\n        data = state.data,\n        signals = state.signals;\n    Object.keys(signals || {}).forEach(key => {\n      df.update(ctx.signals[key], signals[key], SKIP);\n    });\n    Object.keys(data || {}).forEach(key => {\n      df.pulse(ctx.data[key].input, df.changeset().remove(vegaUtil.truthy).insert(data[key]));\n    });\n    (state.subcontext || []).forEach((substate, i) => {\n      const subctx = ctx.subcontext[i];\n      if (subctx) subctx.setState(substate);\n    });\n  }\n\n  /**\n   * Context objects store the current parse state.\n   * Enables lookup of parsed operators, event streams, accessors, etc.\n   * Provides a 'fork' method for creating child contexts for subflows.\n   */\n\n  function context (df, transforms, functions, expr) {\n    return new Context(df, transforms, functions, expr);\n  }\n\n  function Context(df, transforms, functions, expr) {\n    this.dataflow = df;\n    this.transforms = transforms;\n    this.events = df.events.bind(df);\n    this.expr = expr || expressionCodegen, this.signals = {};\n    this.scales = {};\n    this.nodes = {};\n    this.data = {};\n    this.fn = {};\n\n    if (functions) {\n      this.functions = Object.create(functions);\n      this.functions.context = this;\n    }\n  }\n\n  function Subcontext(ctx) {\n    this.dataflow = ctx.dataflow;\n    this.transforms = ctx.transforms;\n    this.events = ctx.events;\n    this.expr = ctx.expr;\n    this.signals = Object.create(ctx.signals);\n    this.scales = Object.create(ctx.scales);\n    this.nodes = Object.create(ctx.nodes);\n    this.data = Object.create(ctx.data);\n    this.fn = Object.create(ctx.fn);\n\n    if (ctx.functions) {\n      this.functions = Object.create(ctx.functions);\n      this.functions.context = this;\n    }\n  }\n\n  Context.prototype = Subcontext.prototype = {\n    fork() {\n      const ctx = new Subcontext(this);\n      (this.subcontext || (this.subcontext = [])).push(ctx);\n      return ctx;\n    },\n\n    detach(ctx) {\n      this.subcontext = this.subcontext.filter(c => c !== ctx); // disconnect all nodes in the subcontext\n      // wipe out targets first for better efficiency\n\n      const keys = Object.keys(ctx.nodes);\n\n      for (const key of keys) ctx.nodes[key]._targets = null;\n\n      for (const key of keys) ctx.nodes[key].detach();\n\n      ctx.nodes = null;\n    },\n\n    get(id) {\n      return this.nodes[id];\n    },\n\n    set(id, node) {\n      return this.nodes[id] = node;\n    },\n\n    add(spec, op) {\n      const ctx = this,\n            df = ctx.dataflow,\n            data = spec.value;\n      ctx.set(spec.id, op);\n\n      if (isCollect(spec.type) && data) {\n        if (data.$ingest) {\n          df.ingest(op, data.$ingest, data.$format);\n        } else if (data.$request) {\n          df.preload(op, data.$request, data.$format);\n        } else {\n          df.pulse(op, df.changeset().insert(data));\n        }\n      }\n\n      if (spec.root) {\n        ctx.root = op;\n      }\n\n      if (spec.parent) {\n        let p = ctx.get(spec.parent.$ref);\n\n        if (p) {\n          df.connect(p, [op]);\n          op.targets().add(p);\n        } else {\n          (ctx.unresolved = ctx.unresolved || []).push(() => {\n            p = ctx.get(spec.parent.$ref);\n            df.connect(p, [op]);\n            op.targets().add(p);\n          });\n        }\n      }\n\n      if (spec.signal) {\n        ctx.signals[spec.signal] = op;\n      }\n\n      if (spec.scale) {\n        ctx.scales[spec.scale] = op;\n      }\n\n      if (spec.data) {\n        for (const name in spec.data) {\n          const data = ctx.data[name] || (ctx.data[name] = {});\n          spec.data[name].forEach(role => data[role] = op);\n        }\n      }\n    },\n\n    resolve() {\n      (this.unresolved || []).forEach(fn => fn());\n      delete this.unresolved;\n      return this;\n    },\n\n    operator(spec, update) {\n      this.add(spec, this.dataflow.add(spec.value, update));\n    },\n\n    transform(spec, type) {\n      this.add(spec, this.dataflow.add(this.transforms[canonicalType(type)]));\n    },\n\n    stream(spec, stream) {\n      this.set(spec.id, stream);\n    },\n\n    update(spec, stream, target, update, params) {\n      this.dataflow.on(stream, target, update, params, spec.options);\n    },\n\n    // expression parsing\n    operatorExpression(expr) {\n      return this.expr.operator(this, expr);\n    },\n\n    parameterExpression(expr) {\n      return this.expr.parameter(this, expr);\n    },\n\n    eventExpression(expr) {\n      return this.expr.event(this, expr);\n    },\n\n    handlerExpression(expr) {\n      return this.expr.handler(this, expr);\n    },\n\n    encodeExpression(encode) {\n      return this.expr.encode(this, encode);\n    },\n\n    // parse methods\n    parse,\n    parseOperator,\n    parseOperatorParameters,\n    parseParameters,\n    parseStream,\n    parseUpdate,\n    // state methods\n    getState,\n    setState\n  };\n\n  exports.context = context;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n})));\n\n};"],
"names":["shadow$provide","global","require","module","exports","factory","define","amd","globalThis","self","vega","vegaUtil","vegaDataflow","expression","ctx","args","code","length","fn","Function","concat","functions","bind","parseParameter","spec","params","isObject","i","n","PARSERS","p","hasOwnProperty","key","parse","Context","df","transforms","expr","dataflow","events","expressionCodegen","signals","scales","nodes","data","Object","create","context","Subcontext","Skip","toSet","Swap","operator","parameter","event","handler","encode","marktype","channels","name","o","stringValue","x2","x","xc","y2","y","yc","codegen","get","path","ref","map","join","comparator","fields","orders","t","f","u","v","lt","getOperator","_","$ref","error","getKey","k","$key","$flat","getExpression","$params","parseParameters","$expr","$name","accessor","parameterExpression","$fields","getField","$field","field","getEncode","$encode","enc","encodeExpression","output","$output","getCompare","$compare","$order","c","array","$tupleid","tupleid","compare","getContext","getSubflow","$subflow","parent","subctx","fork","op","operators","id","set","detachSubflow","op.detachSubflow","detach","getTupleId","SKIP","skip","prototype","subcontext","push","filter","keys","_targets","node","add","value","type","toLowerCase","$ingest","ingest","$format","$request","preload","pulse","changeset","insert","root","connect","targets","unresolved","signal","scale","forEach","role","resolve","update","transform","stream","target","on","options","operatorExpression","eventExpression","handlerExpression","background","eventConfig","locale","entry","parseOperator","parseOperatorParameters","streams","parseStream","updates","parseUpdate","parameters","react","initonly","isArray","undefined","source","merge","apply","slice","between","throttle","debounce","JSON","stringify","consume","srcid","getState","state","dataset","input","recurse","setState","remove","truthy","substate","defineProperty"]
}
