shadow$provide.module$node_modules$semaphore$lib$semaphore=function(global$jscomp$0,require,module,exports){var process=require("module$node_modules$process$browser");(function(global){function semaphore(capacity){var semaphore={capacity:capacity||1,current:0,queue:[],firstHere:!1,take:function(){if(!1===semaphore.firstHere){semaphore.current++;semaphore.firstHere=!0;var isFirst=1}else isFirst=0;var item={n:1};"function"==typeof arguments[0]?item.task=arguments[0]:item.n=arguments[0];2<=arguments.length&&
("function"==typeof arguments[1]?item.task=arguments[1]:item.n=arguments[1]);var task=item.task;item.task=function(){task(semaphore.leave)};if(semaphore.current+item.n-isFirst>semaphore.capacity)return 1===isFirst&&(semaphore.current--,semaphore.firstHere=!1),semaphore.queue.push(item);semaphore.current+=item.n-isFirst;item.task(semaphore.leave);1===isFirst&&(semaphore.firstHere=!1)},leave:function(n){semaphore.current-=n||1;if(semaphore.queue.length)n=semaphore.queue[0],n.n+semaphore.current>semaphore.capacity||
(semaphore.queue.shift(),semaphore.current+=n.n,nextTick(n.task));else if(0>semaphore.current)throw Error("leave called too many times.");},available:function(n){return semaphore.current+(n||1)<=semaphore.capacity}};return semaphore}var nextTick=function(fn){setTimeout(fn,0)};"undefined"!=typeof process&&process&&"function"==typeof process.nextTick&&(nextTick=process.nextTick);"object"===typeof exports?module.exports=semaphore:"function"===typeof define&&define.amd?define(function(){return semaphore}):
global.semaphore=semaphore})(this)}
//# sourceMappingURL=module$node_modules$semaphore$lib$semaphore.js.map
