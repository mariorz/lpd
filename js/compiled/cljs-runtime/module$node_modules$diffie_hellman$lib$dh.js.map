{
"version":3,
"file":"module$node_modules$diffie_hellman$lib$dh.js",
"lineCount":6,
"mappings":"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",
"sources":["node_modules/diffie-hellman/lib/dh.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$diffie_hellman$lib$dh\"] = function(global,require,module,exports) {\nvar Buffer = require('buffer').Buffer;\nvar BN = require('bn.js');\nvar MillerRabin = require('miller-rabin');\nvar millerRabin = new MillerRabin();\nvar TWENTYFOUR = new BN(24);\nvar ELEVEN = new BN(11);\nvar TEN = new BN(10);\nvar THREE = new BN(3);\nvar SEVEN = new BN(7);\nvar primes = require('./generatePrime');\nvar randomBytes = require('randombytes');\nmodule.exports = DH;\n\nfunction setPublicKey(pub, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(pub)) {\n    pub = new Buffer(pub, enc);\n  }\n  this._pub = new BN(pub);\n  return this;\n}\n\nfunction setPrivateKey(priv, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(priv)) {\n    priv = new Buffer(priv, enc);\n  }\n  this._priv = new BN(priv);\n  return this;\n}\n\nvar primeCache = {};\nfunction checkPrime(prime, generator) {\n  var gen = generator.toString('hex');\n  var hex = [gen, prime.toString(16)].join('_');\n  if (hex in primeCache) {\n    return primeCache[hex];\n  }\n  var error = 0;\n\n  if (prime.isEven() ||\n    !primes.simpleSieve ||\n    !primes.fermatTest(prime) ||\n    !millerRabin.test(prime)) {\n    //not a prime so +1\n    error += 1;\n\n    if (gen === '02' || gen === '05') {\n      // we'd be able to check the generator\n      // it would fail so +8\n      error += 8;\n    } else {\n      //we wouldn't be able to test the generator\n      // so +4\n      error += 4;\n    }\n    primeCache[hex] = error;\n    return error;\n  }\n  if (!millerRabin.test(prime.shrn(1))) {\n    //not a safe prime\n    error += 2;\n  }\n  var rem;\n  switch (gen) {\n    case '02':\n      if (prime.mod(TWENTYFOUR).cmp(ELEVEN)) {\n        // unsuidable generator\n        error += 8;\n      }\n      break;\n    case '05':\n      rem = prime.mod(TEN);\n      if (rem.cmp(THREE) && rem.cmp(SEVEN)) {\n        // prime mod 10 needs to equal 3 or 7\n        error += 8;\n      }\n      break;\n    default:\n      error += 4;\n  }\n  primeCache[hex] = error;\n  return error;\n}\n\nfunction DH(prime, generator, malleable) {\n  this.setGenerator(generator);\n  this.__prime = new BN(prime);\n  this._prime = BN.mont(this.__prime);\n  this._primeLen = prime.length;\n  this._pub = undefined;\n  this._priv = undefined;\n  this._primeCode = undefined;\n  if (malleable) {\n    this.setPublicKey = setPublicKey;\n    this.setPrivateKey = setPrivateKey;\n  } else {\n    this._primeCode = 8;\n  }\n}\nObject.defineProperty(DH.prototype, 'verifyError', {\n  enumerable: true,\n  get: function () {\n    if (typeof this._primeCode !== 'number') {\n      this._primeCode = checkPrime(this.__prime, this.__gen);\n    }\n    return this._primeCode;\n  }\n});\nDH.prototype.generateKeys = function () {\n  if (!this._priv) {\n    this._priv = new BN(randomBytes(this._primeLen));\n  }\n  this._pub = this._gen.toRed(this._prime).redPow(this._priv).fromRed();\n  return this.getPublicKey();\n};\n\nDH.prototype.computeSecret = function (other) {\n  other = new BN(other);\n  other = other.toRed(this._prime);\n  var secret = other.redPow(this._priv).fromRed();\n  var out = new Buffer(secret.toArray());\n  var prime = this.getPrime();\n  if (out.length < prime.length) {\n    var front = new Buffer(prime.length - out.length);\n    front.fill(0);\n    out = Buffer.concat([front, out]);\n  }\n  return out;\n};\n\nDH.prototype.getPublicKey = function getPublicKey(enc) {\n  return formatReturnValue(this._pub, enc);\n};\n\nDH.prototype.getPrivateKey = function getPrivateKey(enc) {\n  return formatReturnValue(this._priv, enc);\n};\n\nDH.prototype.getPrime = function (enc) {\n  return formatReturnValue(this.__prime, enc);\n};\n\nDH.prototype.getGenerator = function (enc) {\n  return formatReturnValue(this._gen, enc);\n};\n\nDH.prototype.setGenerator = function (gen, enc) {\n  enc = enc || 'utf8';\n  if (!Buffer.isBuffer(gen)) {\n    gen = new Buffer(gen, enc);\n  }\n  this.__gen = gen;\n  this._gen = new BN(gen);\n  return this;\n};\n\nfunction formatReturnValue(bn, enc) {\n  var buf = new Buffer(bn.toArray());\n  if (!enc) {\n    return buf;\n  } else {\n    return buf.toString(enc);\n  }\n}\n\n};"],
"names":["shadow$provide","global","require","module","exports","setPublicKey","pub","enc","Buffer","isBuffer","_pub","BN","setPrivateKey","priv","_priv","DH","prime","generator","malleable","setGenerator","__prime","_prime","mont","_primeLen","length","_primeCode","undefined","formatReturnValue","bn","buf","toArray","toString","millerRabin","MillerRabin","TWENTYFOUR","ELEVEN","TEN","THREE","SEVEN","primes","randomBytes","primeCache","Object","defineProperty","prototype","enumerable","get","gen","__gen","hex","join","error","isEven","simpleSieve","fermatTest","test","shrn","mod","cmp","rem","generateKeys","DH.prototype.generateKeys","_gen","toRed","redPow","fromRed","getPublicKey","computeSecret","DH.prototype.computeSecret","other","secret","out","getPrime","front","fill","concat","DH.prototype.getPublicKey","getPrivateKey","DH.prototype.getPrivateKey","DH.prototype.getPrime","getGenerator","DH.prototype.getGenerator","DH.prototype.setGenerator"]
}
