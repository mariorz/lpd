shadow$provide.module$node_modules$$portis$web3$es$utils$getTxGas=function(global,require,module,exports){function safeTxGas(query,txParams,blockGasLimitHex){return __awaiter(this,void 0,void 0,function(){var gasLimitSpecified,recipient,hasRecipient,code,codeIsEmpty,err,blockGasLimitBN,saferGasLimitBN;return __generator(this,function(_a){switch(_a.label){case 0:if(gasLimitSpecified=!!txParams.gas)return[2,{safeGas:txParams.gas,simpleSend:!1,gasLimitSpecified:!0}];recipient=txParams.to;return(hasRecipient=
!!recipient)?[4,query.getCode(recipient)]:[3,2];case 1:code=_a.sent();if(codeIsEmpty=!code||"0x"===code||"0x0"===code){if(txParams.data)throw err=Error("Trying to call a function on a non-contract address"),err;return[2,{safeGas:SIMPLE_GAS_COST,simpleSend:!0,gasLimitSpecified:!1}]}_a.label=2;case 2:_a=blockGasLimitBN=new BN(stripHexPrefix(blockGasLimitHex),16);var numBN=new BN(19),denomBN=new BN(20);saferGasLimitBN=_a.mul(numBN).div(denomBN);return[2,{safeGas:addHexPrefix(saferGasLimitBN.toString(16)),
simpleSend:!1,gasLimitSpecified:!1}]}})})}function estimateTxGas(query,txParams,blockGasLimitHex,safeGas){return __awaiter(this,void 0,void 0,function(){var estimatedGas,_a;return __generator(this,function(_b){switch(_b.label){case 0:return txParams.gas=safeGas,_a=addHexPrefix,[4,query.estimateGas(txParams)];case 1:estimatedGas=_a.apply(void 0,[_b.sent()]);_b=new BN(stripHexPrefix(estimatedGas),16);var upperGasLimitBn=(new BN(stripHexPrefix(blockGasLimitHex),16)).muln(.9),bufferedGasLimitBn=_b.muln(1.5);
_b=_b.gt(upperGasLimitBn)?addHexPrefix(_b.toString(16)):bufferedGasLimitBn.lt(upperGasLimitBn)?addHexPrefix(bufferedGasLimitBn.toString(16)):addHexPrefix(upperGasLimitBn.toString(16));return[2,_b]}})})}Object.defineProperty(exports,"__esModule",{value:!0});exports.getTxGas=function(query,txParams){return __awaiter(this,void 0,void 0,function(){var block,_a,safeGas,simpleSend,gasLimitSpecified,gas;return __generator(this,function(_b){switch(_b.label){case 0:return[4,query.getBlockByNumber("latest",
!1)];case 1:return block=_b.sent(),[4,safeTxGas(query,txParams,block.gasLimit)];case 2:_a=_b.sent();safeGas=_a.safeGas;simpleSend=_a.simpleSend;gasLimitSpecified=_a.gasLimitSpecified;if(simpleSend||gasLimitSpecified)return[2,safeGas];_b.label=3;case 3:return _b.trys.push([3,5,,6]),[4,estimateTxGas(query,txParams,block.gasLimit,safeGas)];case 4:return gas=_b.sent(),[2,gas];case 5:return _b.sent(),[2,safeGas];case 6:return[2]}})})};var __awaiter=function(thisArg,_arguments,P,generator){return new (P||
(P=Promise))(function(resolve$jscomp$0,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve$jscomp$0(result.value):(new P(function(resolve){resolve(result.value)})).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=function(thisArg,body){function verb(n){return function(v){return step([n,v])}}
function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=0<t.length&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===
op[0]&&(!t||op[1]>t[0]&&op[1]<t[3]))_.label=op[1];else if(6===op[0]&&_.label<t[1])_.label=t[1],t=op;else if(t&&_.label<t[2])_.label=t[2],_.ops.push(op);else{t[2]&&_.ops.pop();_.trys.pop();continue}}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),"throw":verb(1),"return":verb(2)},"function"===typeof Symbol&&(g[Symbol.iterator]=
function(){return this}),g};global=require("module$node_modules$ethereumjs_util$dist$index");var addHexPrefix=global.addHexPrefix,stripHexPrefix=global.stripHexPrefix,BN=global.BN,SIMPLE_GAS_COST="0x5208"}
//# sourceMappingURL=module$node_modules$$portis$web3$es$utils$getTxGas.js.map
