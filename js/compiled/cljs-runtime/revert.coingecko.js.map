{"version":3,"sources":["revert/coingecko.cljs"],"mappings":"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","names":["revert.coingecko/<token-prices","addresses","c__52208__auto__","cljs.core.async.chan","cljs.core.async.impl.dispatch/run","f__52209__auto__","switch__52185__auto__","state_163358","state_val_163359","inst_163334","inst_163337","inst_163338","inst_163335","inst_163336","inst_163339","inst_163340","inst_163341","cljs.core/PersistentHashMap","inst_163342","statearr-163364","cljs.core.async.impl.ioc-helpers/take!","inst_163344","inst_163345","inst_163346","p1__163327#","inst_163347","inst_163348","p1__163328#","inst_163349","inst_163350","inst_163351","inst_163352","inst_163353","p1__163329#","inst_163354","inst_163355","inst_163356","cljs.core.async.impl.ioc-helpers/return-chan","statearr-163367","state-machine__52186__auto__","ret-value__52187__auto__","result__52188__auto__","cljs.core/keyword-identical?","ex__52189__auto__","e163368","statearr-163369","cljs.core/seq","statearr-163370","cljs.core/first","state__52210__auto__","statearr-163371","cljs.core.async.impl.ioc-helpers/USER-START-IDX","cljs.core.async.impl.ioc-helpers/run-state-machine-wrapped","base-url","addy-args","goog.string/urlEncode","cljs.core.apply","cljs.core/str","clojure.string.join","full-url","data","cljs_http.client.get","data-sans-ts","revert.utils/update-values","cljs.core.dissoc","data'","cljs.core.merge_with","n","js/module$node_modules$bignumber_DOT_js$bignumber","cljs.core/zipmap","cljs.core.map","cljs.core/name","cljs.core/keys","clojure.set/rename-keys","cljs.core/vals","revert.coingecko/<historic-token-prices","address","state_163384","state_val_163385","inst_163374","inst_163375","inst_163376","inst_163377","inst_163378","inst_163380","inst_163381","inst_163382","statearr-163387","e163388","statearr-163389","statearr-163390","statearr-163392"],"sourcesContent":["(ns revert.coingecko\n  (:require [cljs.core.async :refer [go]]\n            [cljs.core.async.interop :refer-macros [<p!]]\n            [cljs-http.client :as http]\n            [bignumber.js :as BigNumber]\n            [bignumber.core]\n            [goog.string :as string]\n            [goog.uri.utils :as uri]\n            [revert.utils :as u]))\n\n\n(defn <token-prices\n  [addresses]\n  (go (let [base-url (str \"https://api.coingecko.com/\"\n                          \"api/v3/simple/token_price/ethereum?\"\n                          \"vs_currencies=usd%2Ceth&include_last_updated_at=true\"\n                          \"&contract_addresses=\")\n            addy-args (string/urlEncode\n                       (apply str (clojure.string-join \",\" addresses)))\n            full-url (str base-url addy-args)\n            data (:body\n                  (<! (http/get\n                       full-url\n                       {:with-credentials? false})))\n            data-sans-ts (u/update-values\n                          data\n                          #(dissoc % :last_updated_at))\n            data' (merge-with data\n                              (u/update-values\n                               data-sans-ts\n                               #(u/update-values % (fn [n] (BigNumber. (str n))))))]\n        (zipmap\n         (map name (keys data'))\n         (map #(clojure.set/rename-keys % {:last_updated_at :ts\n                                           :usd \"usd\"\n                                           :eth \"eth\"})\n              (vals data'))))))\n\n\n(defn <historic-token-prices\n  [address]\n  (go (let [base-url (str \"https://api.coingecko.com/\"\n                          \"api/v3/coins/ethereum/contract/\"\n                          address\n                          \"/market_chart/?vs_currency=usd&days=700\")\n            full-url base-url\n            ;;- (println full-url)\n            data (:prices (:body\n                  (<! (http/get\n                       full-url\n                       {:with-credentials? false}))))]\n        data\n        #_(zipmap\n         (map name (keys data'))\n         (map #(clojure.set/rename-keys % {:last_updated_at :ts\n                                           :usd \"usd\"\n                                           :eth \"eth\"})\n              (vals data'))))))\n\n\n#_(go (def token-prices (<! (<coingecko-token-prices token-ids))))\n\n"]}