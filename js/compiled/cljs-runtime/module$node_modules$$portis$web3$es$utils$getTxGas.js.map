{
"version":3,
"file":"module$node_modules$$portis$web3$es$utils$getTxGas.js",
"lineCount":9,
"mappings":"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",
"sources":["node_modules/@portis/web3/es/utils/getTxGas.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$$portis$web3$es$utils$getTxGas\"] = function(global,require,module,exports) {\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getTxGas = getTxGas;\n\nvar __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = void 0 && (void 0).__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar _a = require('ethereumjs-util'),\n    addHexPrefix = _a.addHexPrefix,\n    stripHexPrefix = _a.stripHexPrefix,\n    BN = _a.BN;\n\nvar SIMPLE_GAS_COST = '0x5208'; // Hex for 21000, cost of a simple send.\n\nfunction getTxGas(query, txParams) {\n  return __awaiter(this, void 0, void 0, function () {\n    var block, _a, safeGas, simpleSend, gasLimitSpecified, gas, error_1;\n\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          return [4\n          /*yield*/\n          , query.getBlockByNumber('latest', false)];\n\n        case 1:\n          block = _b.sent();\n          return [4\n          /*yield*/\n          , safeTxGas(query, txParams, block.gasLimit)];\n\n        case 2:\n          _a = _b.sent(), safeGas = _a.safeGas, simpleSend = _a.simpleSend, gasLimitSpecified = _a.gasLimitSpecified;\n\n          if (simpleSend || gasLimitSpecified) {\n            return [2\n            /*return*/\n            , safeGas];\n          }\n\n          _b.label = 3;\n\n        case 3:\n          _b.trys.push([3, 5,, 6]);\n\n          return [4\n          /*yield*/\n          , estimateTxGas(query, txParams, block.gasLimit, safeGas)];\n\n        case 4:\n          gas = _b.sent();\n          return [2\n          /*return*/\n          , gas];\n\n        case 5:\n          error_1 = _b.sent();\n          return [2\n          /*return*/\n          , safeGas];\n\n        case 6:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  });\n}\n\nfunction safeTxGas(query, txParams, blockGasLimitHex) {\n  return __awaiter(this, void 0, void 0, function () {\n    var gasLimitSpecified, recipient, hasRecipient, code, codeIsEmpty, err, blockGasLimitBN, saferGasLimitBN;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          gasLimitSpecified = Boolean(txParams.gas); // if it is, use that value\n\n          if (gasLimitSpecified) {\n            return [2\n            /*return*/\n            , {\n              safeGas: txParams.gas,\n              simpleSend: false,\n              gasLimitSpecified: true\n            }];\n          }\n\n          recipient = txParams.to;\n          hasRecipient = Boolean(recipient);\n          if (!hasRecipient) return [3\n          /*break*/\n          , 2];\n          return [4\n          /*yield*/\n          , query.getCode(recipient)];\n\n        case 1:\n          code = _a.sent();\n          codeIsEmpty = !code || code === '0x' || code === '0x0';\n\n          if (codeIsEmpty) {\n            // if there's data in the params, but there's no contract code, it's not a valid transaction\n            if (txParams.data) {\n              err = new Error('Trying to call a function on a non-contract address');\n              throw err;\n            } // This is a standard ether simple send, gas requirement is exactly 21k\n\n\n            return [2\n            /*return*/\n            , {\n              safeGas: SIMPLE_GAS_COST,\n              simpleSend: true,\n              gasLimitSpecified: false\n            }];\n          }\n\n          _a.label = 2;\n\n        case 2:\n          blockGasLimitBN = hexToBn(blockGasLimitHex);\n          saferGasLimitBN = BnMultiplyByFraction(blockGasLimitBN, 19, 20);\n          return [2\n          /*return*/\n          , {\n            safeGas: bnToHex(saferGasLimitBN),\n            simpleSend: false,\n            gasLimitSpecified: false\n          }];\n      }\n    });\n  });\n}\n\nfunction estimateTxGas(query, txParams, blockGasLimitHex, safeGas) {\n  return __awaiter(this, void 0, void 0, function () {\n    var estimatedGas, _a;\n\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          txParams.gas = safeGas;\n          _a = addHexPrefix;\n          return [4\n          /*yield*/\n          , query.estimateGas(txParams)];\n\n        case 1:\n          estimatedGas = _a.apply(void 0, [_b.sent()]);\n          return [2\n          /*return*/\n          , addGasBuffer(estimatedGas, blockGasLimitHex)];\n      }\n    });\n  });\n}\n\nfunction addGasBuffer(initialGasLimitHex, blockGasLimitHex) {\n  var initialGasLimitBn = hexToBn(initialGasLimitHex);\n  var blockGasLimitBn = hexToBn(blockGasLimitHex);\n  var upperGasLimitBn = blockGasLimitBn.muln(0.9);\n  var bufferedGasLimitBn = initialGasLimitBn.muln(1.5); // if initialGasLimit is above blockGasLimit, dont modify it\n\n  if (initialGasLimitBn.gt(upperGasLimitBn)) return bnToHex(initialGasLimitBn); // if bufferedGasLimit is below blockGasLimit, use bufferedGasLimit\n\n  if (bufferedGasLimitBn.lt(upperGasLimitBn)) return bnToHex(bufferedGasLimitBn); // otherwise use blockGasLimit\n\n  return bnToHex(upperGasLimitBn);\n}\n\nfunction hexToBn(inputHex) {\n  return new BN(stripHexPrefix(inputHex), 16);\n}\n\nfunction bnToHex(inputBn) {\n  return addHexPrefix(inputBn.toString(16));\n}\n\nfunction BnMultiplyByFraction(targetBN, numerator, denominator) {\n  var numBN = new BN(numerator);\n  var denomBN = new BN(denominator);\n  return targetBN.mul(numBN).div(denomBN);\n}\n};"],
"names":["shadow$provide","global","require","module","exports","safeTxGas","query","txParams","blockGasLimitHex","__awaiter","gasLimitSpecified","recipient","hasRecipient","code","codeIsEmpty","err","blockGasLimitBN","saferGasLimitBN","__generator","_a","label","gas","safeGas","simpleSend","to","getCode","sent","data","Error","SIMPLE_GAS_COST","BN","stripHexPrefix","numBN","numerator","denomBN","denominator","targetBN","mul","div","addHexPrefix","toString","estimateTxGas","estimatedGas","_b","estimateGas","apply","initialGasLimitBn","upperGasLimitBn","blockGasLimitBn","muln","bufferedGasLimitBn","gt","lt","Object","defineProperty","value","getTxGas","block","getBlockByNumber","gasLimit","trys","push","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","then","body","verb","n","v","op","f","TypeError","_","y","t","call","ops","pop","length","g","Symbol","iterator"]
}
