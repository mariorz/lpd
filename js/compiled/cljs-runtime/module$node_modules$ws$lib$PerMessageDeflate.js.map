{
"version":3,
"file":"module$node_modules$ws$lib$PerMessageDeflate.js",
"lineCount":17,
"mappings":"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",
"sources":["node_modules/ws/lib/PerMessageDeflate.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$ws$lib$PerMessageDeflate\"] = function(global,require,module,exports) {\nvar process = require('process');\n'use strict';\n\nconst safeBuffer = require('safe-buffer');\nconst Limiter = require('async-limiter');\nconst zlib = require('zlib');\n\nconst bufferUtil = require('./BufferUtil');\n\nconst Buffer = safeBuffer.Buffer;\n\nconst TRAILER = Buffer.from([0x00, 0x00, 0xff, 0xff]);\nconst EMPTY_BLOCK = Buffer.from([0x00]);\n\nconst kWriteInProgress = Symbol('write-in-progress');\nconst kPendingClose = Symbol('pending-close');\nconst kTotalLength = Symbol('total-length');\nconst kCallback = Symbol('callback');\nconst kBuffers = Symbol('buffers');\nconst kError = Symbol('error');\nconst kOwner = Symbol('owner');\n\n//\n// We limit zlib concurrency, which prevents severe memory fragmentation\n// as documented in https://github.com/nodejs/node/issues/8871#issuecomment-250915913\n// and https://github.com/websockets/ws/issues/1202\n//\n// Intentionally global; it's the global thread pool that's an issue.\n//\nlet zlibLimiter;\n\n/**\n * permessage-deflate implementation.\n */\nclass PerMessageDeflate {\n  /**\n   * Creates a PerMessageDeflate instance.\n   *\n   * @param {Object} options Configuration options\n   * @param {Boolean} options.serverNoContextTakeover Request/accept disabling\n   *     of server context takeover\n   * @param {Boolean} options.clientNoContextTakeover Advertise/acknowledge\n   *     disabling of client context takeover\n   * @param {(Boolean|Number)} options.serverMaxWindowBits Request/confirm the\n   *     use of a custom server window size\n   * @param {(Boolean|Number)} options.clientMaxWindowBits Advertise support\n   *     for, or request, a custom client window size\n   * @param {Number} options.level The value of zlib's `level` param\n   * @param {Number} options.memLevel The value of zlib's `memLevel` param\n   * @param {Number} options.threshold Size (in bytes) below which messages\n   *     should not be compressed\n   * @param {Number} options.concurrencyLimit The number of concurrent calls to\n   *     zlib\n   * @param {Boolean} isServer Create the instance in either server or client\n   *     mode\n   * @param {Number} maxPayload The maximum allowed message length\n   */\n  constructor (options, isServer, maxPayload) {\n    this._maxPayload = maxPayload | 0;\n    this._options = options || {};\n    this._threshold = this._options.threshold !== undefined\n      ? this._options.threshold\n      : 1024;\n    this._isServer = !!isServer;\n    this._deflate = null;\n    this._inflate = null;\n\n    this.params = null;\n\n    if (!zlibLimiter) {\n      const concurrency = this._options.concurrencyLimit !== undefined\n        ? this._options.concurrencyLimit\n        : 10;\n      zlibLimiter = new Limiter({ concurrency });\n    }\n  }\n\n  /**\n   * @type {String}\n   */\n  static get extensionName () {\n    return 'permessage-deflate';\n  }\n\n  /**\n   * Create extension parameters offer.\n   *\n   * @return {Object} Extension parameters\n   * @public\n   */\n  offer () {\n    const params = {};\n\n    if (this._options.serverNoContextTakeover) {\n      params.server_no_context_takeover = true;\n    }\n    if (this._options.clientNoContextTakeover) {\n      params.client_no_context_takeover = true;\n    }\n    if (this._options.serverMaxWindowBits) {\n      params.server_max_window_bits = this._options.serverMaxWindowBits;\n    }\n    if (this._options.clientMaxWindowBits) {\n      params.client_max_window_bits = this._options.clientMaxWindowBits;\n    } else if (this._options.clientMaxWindowBits == null) {\n      params.client_max_window_bits = true;\n    }\n\n    return params;\n  }\n\n  /**\n   * Accept extension offer.\n   *\n   * @param {Array} paramsList Extension parameters\n   * @return {Object} Accepted configuration\n   * @public\n   */\n  accept (paramsList) {\n    paramsList = this.normalizeParams(paramsList);\n\n    var params;\n    if (this._isServer) {\n      params = this.acceptAsServer(paramsList);\n    } else {\n      params = this.acceptAsClient(paramsList);\n    }\n\n    this.params = params;\n    return params;\n  }\n\n  /**\n   * Releases all resources used by the extension.\n   *\n   * @public\n   */\n  cleanup () {\n    if (this._inflate) {\n      if (this._inflate[kWriteInProgress]) {\n        this._inflate[kPendingClose] = true;\n      } else {\n        this._inflate.close();\n        this._inflate = null;\n      }\n    }\n    if (this._deflate) {\n      if (this._deflate[kWriteInProgress]) {\n        this._deflate[kPendingClose] = true;\n      } else {\n        this._deflate.close();\n        this._deflate = null;\n      }\n    }\n  }\n\n  /**\n   * Accept extension offer from client.\n   *\n   * @param {Array} paramsList Extension parameters\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsServer (paramsList) {\n    const accepted = {};\n    const result = paramsList.some((params) => {\n      if (\n        (this._options.serverNoContextTakeover === false &&\n          params.server_no_context_takeover) ||\n        (this._options.serverMaxWindowBits === false &&\n          params.server_max_window_bits) ||\n        (typeof this._options.serverMaxWindowBits === 'number' &&\n          typeof params.server_max_window_bits === 'number' &&\n          this._options.serverMaxWindowBits > params.server_max_window_bits) ||\n        (typeof this._options.clientMaxWindowBits === 'number' &&\n          !params.client_max_window_bits)\n      ) {\n        return;\n      }\n\n      if (\n        this._options.serverNoContextTakeover ||\n        params.server_no_context_takeover\n      ) {\n        accepted.server_no_context_takeover = true;\n      }\n      if (\n        this._options.clientNoContextTakeover ||\n        (this._options.clientNoContextTakeover !== false &&\n          params.client_no_context_takeover)\n      ) {\n        accepted.client_no_context_takeover = true;\n      }\n      if (typeof this._options.serverMaxWindowBits === 'number') {\n        accepted.server_max_window_bits = this._options.serverMaxWindowBits;\n      } else if (typeof params.server_max_window_bits === 'number') {\n        accepted.server_max_window_bits = params.server_max_window_bits;\n      }\n      if (typeof this._options.clientMaxWindowBits === 'number') {\n        accepted.client_max_window_bits = this._options.clientMaxWindowBits;\n      } else if (\n        this._options.clientMaxWindowBits !== false &&\n        typeof params.client_max_window_bits === 'number'\n      ) {\n        accepted.client_max_window_bits = params.client_max_window_bits;\n      }\n      return true;\n    });\n\n    if (!result) throw new Error(\"Doesn't support the offered configuration\");\n\n    return accepted;\n  }\n\n  /**\n   * Accept extension response from server.\n   *\n   * @param {Array} paramsList Extension parameters\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsClient (paramsList) {\n    const params = paramsList[0];\n\n    if (\n      this._options.clientNoContextTakeover === false &&\n      params.client_no_context_takeover\n    ) {\n      throw new Error('Invalid value for \"client_no_context_takeover\"');\n    }\n\n    if (\n      (typeof this._options.clientMaxWindowBits === 'number' &&\n        (!params.client_max_window_bits ||\n          params.client_max_window_bits > this._options.clientMaxWindowBits)) ||\n      (this._options.clientMaxWindowBits === false &&\n        params.client_max_window_bits)\n    ) {\n      throw new Error('Invalid value for \"client_max_window_bits\"');\n    }\n\n    return params;\n  }\n\n  /**\n   * Normalize extensions parameters.\n   *\n   * @param {Array} paramsList Extension parameters\n   * @return {Array} Normalized extensions parameters\n   * @private\n   */\n  normalizeParams (paramsList) {\n    return paramsList.map((params) => {\n      Object.keys(params).forEach((key) => {\n        var value = params[key];\n        if (value.length > 1) {\n          throw new Error(`Multiple extension parameters for ${key}`);\n        }\n\n        value = value[0];\n\n        switch (key) {\n          case 'server_no_context_takeover':\n          case 'client_no_context_takeover':\n            if (value !== true) {\n              throw new Error(`invalid extension parameter value for ${key} (${value})`);\n            }\n            params[key] = true;\n            break;\n          case 'server_max_window_bits':\n          case 'client_max_window_bits':\n            if (typeof value === 'string') {\n              value = parseInt(value, 10);\n              if (\n                Number.isNaN(value) ||\n                value < zlib.Z_MIN_WINDOWBITS ||\n                value > zlib.Z_MAX_WINDOWBITS\n              ) {\n                throw new Error(`invalid extension parameter value for ${key} (${value})`);\n              }\n            }\n            if (!this._isServer && value === true) {\n              throw new Error(`Missing extension parameter value for ${key}`);\n            }\n            params[key] = value;\n            break;\n          default:\n            throw new Error(`Not defined extension parameter (${key})`);\n        }\n      });\n      return params;\n    });\n  }\n\n  /**\n   * Decompress data. Concurrency limited by async-limiter.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  decompress (data, fin, callback) {\n    zlibLimiter.push((done) => {\n      this._decompress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Compress data. Concurrency limited by async-limiter.\n   *\n   * @param {Buffer} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  compress (data, fin, callback) {\n    zlibLimiter.push((done) => {\n      this._compress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Decompress data.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _decompress (data, fin, callback) {\n    const endpoint = this._isServer ? 'client' : 'server';\n\n    if (!this._inflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits = typeof this.params[key] !== 'number'\n        ? zlib.Z_DEFAULT_WINDOWBITS\n        : this.params[key];\n\n      this._inflate = zlib.createInflateRaw({ windowBits });\n      this._inflate[kTotalLength] = 0;\n      this._inflate[kBuffers] = [];\n      this._inflate[kOwner] = this;\n      this._inflate.on('error', inflateOnError);\n      this._inflate.on('data', inflateOnData);\n    }\n\n    this._inflate[kCallback] = callback;\n    this._inflate[kWriteInProgress] = true;\n\n    this._inflate.write(data);\n    if (fin) this._inflate.write(TRAILER);\n\n    this._inflate.flush(() => {\n      const err = this._inflate[kError];\n\n      if (err) {\n        this._inflate.close();\n        this._inflate = null;\n        callback(err);\n        return;\n      }\n\n      const data = bufferUtil.concat(\n        this._inflate[kBuffers],\n        this._inflate[kTotalLength]\n      );\n\n      if (\n        (fin && this.params[`${endpoint}_no_context_takeover`]) ||\n        this._inflate[kPendingClose]\n      ) {\n        this._inflate.close();\n        this._inflate = null;\n      } else {\n        this._inflate[kWriteInProgress] = false;\n        this._inflate[kTotalLength] = 0;\n        this._inflate[kBuffers] = [];\n      }\n\n      callback(null, data);\n    });\n  }\n\n  /**\n   * Compress data.\n   *\n   * @param {Buffer} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _compress (data, fin, callback) {\n    if (!data || data.length === 0) {\n      process.nextTick(callback, null, EMPTY_BLOCK);\n      return;\n    }\n\n    const endpoint = this._isServer ? 'server' : 'client';\n\n    if (!this._deflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits = typeof this.params[key] !== 'number'\n        ? zlib.Z_DEFAULT_WINDOWBITS\n        : this.params[key];\n\n      this._deflate = zlib.createDeflateRaw({\n        memLevel: this._options.memLevel,\n        level: this._options.level,\n        flush: zlib.Z_SYNC_FLUSH,\n        windowBits\n      });\n\n      this._deflate[kTotalLength] = 0;\n      this._deflate[kBuffers] = [];\n\n      //\n      // `zlib.DeflateRaw` emits an `'error'` event only when an attempt to use\n      // it is made after it has already been closed. This cannot happen here,\n      // so we only add a listener for the `'data'` event.\n      //\n      this._deflate.on('data', deflateOnData);\n    }\n\n    this._deflate[kWriteInProgress] = true;\n\n    this._deflate.write(data);\n    this._deflate.flush(zlib.Z_SYNC_FLUSH, () => {\n      var data = bufferUtil.concat(\n        this._deflate[kBuffers],\n        this._deflate[kTotalLength]\n      );\n\n      if (fin) data = data.slice(0, data.length - 4);\n\n      if (\n        (fin && this.params[`${endpoint}_no_context_takeover`]) ||\n        this._deflate[kPendingClose]\n      ) {\n        this._deflate.close();\n        this._deflate = null;\n      } else {\n        this._deflate[kWriteInProgress] = false;\n        this._deflate[kTotalLength] = 0;\n        this._deflate[kBuffers] = [];\n      }\n\n      callback(null, data);\n    });\n  }\n}\n\nmodule.exports = PerMessageDeflate;\n\n/**\n * The listener of the `zlib.DeflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction deflateOnData (chunk) {\n  this[kBuffers].push(chunk);\n  this[kTotalLength] += chunk.length;\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction inflateOnData (chunk) {\n  this[kTotalLength] += chunk.length;\n\n  if (\n    this[kOwner]._maxPayload < 1 ||\n    this[kTotalLength] <= this[kOwner]._maxPayload\n  ) {\n    this[kBuffers].push(chunk);\n    return;\n  }\n\n  this[kError] = new Error('max payload size exceeded');\n  this[kError].closeCode = 1009;\n  this.removeListener('data', inflateOnData);\n  this.reset();\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'error'` event.\n *\n * @param {Error} err The emitted error\n * @private\n */\nfunction inflateOnError (err) {\n  //\n  // There is no need to call `Zlib#close()` as the handle is automatically\n  // closed when an error is emitted.\n  //\n  this[kOwner]._inflate = null;\n  this[kCallback](err);\n}\n\n};"],
"names":["shadow$provide","global","require","module","exports","deflateOnData","chunk","kBuffers","push","kTotalLength","length","inflateOnData","kOwner","_maxPayload","kError","Error","closeCode","removeListener","reset","inflateOnError","err","_inflate","kCallback","process","safeBuffer","Limiter","zlib","bufferUtil","Buffer","TRAILER","from","EMPTY_BLOCK","kWriteInProgress","Symbol","kPendingClose","zlibLimiter","PerMessageDeflate","constructor","options","isServer","maxPayload","_options","_threshold","undefined","threshold","_isServer","params","_deflate","concurrency","concurrencyLimit","offer","serverNoContextTakeover","server_no_context_takeover","clientNoContextTakeover","client_no_context_takeover","serverMaxWindowBits","server_max_window_bits","clientMaxWindowBits","client_max_window_bits","accept","paramsList","normalizeParams","acceptAsServer","acceptAsClient","cleanup","close","accepted","result","some","map","Object","keys","forEach","key","value","parseInt","Number","isNaN","Z_MIN_WINDOWBITS","Z_MAX_WINDOWBITS","decompress","data","fin","callback","done","_decompress","compress","_compress","endpoint","createInflateRaw","windowBits","Z_DEFAULT_WINDOWBITS","on","write","flush","concat","createDeflateRaw","memLevel","level","Z_SYNC_FLUSH","slice","nextTick","extensionName"]
}
